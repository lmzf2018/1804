
1.装包
软件源来源？ 官网下载  XXX.主.次（偶数为稳定版）.修改次数
软件包封包类型（rpm 源码）？
源码 可以自定义配置和安装  必须解决依赖关系
rpm 软件是封装好的不可以自定义安装  安装卸载简单
     rpm -ivh 
     rpm  -e
2.[root@host50 ~]# ss -antup | grep mysqld
tcp    LISTEN     0      80       :::3306               :::*       users:(("mysqld",pid=3468,fd=18))
[root@host50 ~]# ps  -C  mysqld   //单独查
  PID TTY          TIME CMD
 3468 ?        00:00:00 mysqld

###########################################################

数据库  庞丽静工作邮箱:  panglj@tedu.cn

rhel7     yum -y install mariadb-server
rhel6     yum -y install mysql

学习环境:
禁用selinux
关闭防火墙
ftp 176.19.7.250
Name:  anonymous                          //匿名登录ftp
Password： Enter



createrepo /var/ftp/mysql                 //创建yum仓库

[mysql]
name=mysql
baseurl=ftp://192.168.4.254/mysql
enable=1
gpgcheck=0

[dvd]
name=rhel7
baseurl=ftp://192.168.4.254/rhel7
enable=1
gpgcheck=0


yum -y install mysql-*                     //装包

systemctl start mysqld                     //启服务

grep -i password /var/log/mysqld.log       //查密码

mysql -uroot -p"密码"    登录

set global validate_password_policy=0;     //修改安全策略只要求长度

set global validate_password_length=6;     //修改密码长度为6

alter user user() identified by "123456";  //修改密码为123456

vim /etc/my.cnf                            //永久修改
validate_password_policy=0      
validate_password_length=6



数据库的命名规则:可以使用数字/字母/下划线,但不能为纯数字
                区分大小写,具有唯一性
                不可以使用指令关键字,特殊字符

SQL命令:
show databases;            	//显示已有的库
create database (库名);    	//创建库
drop database (库名);       	//删除库
use (库名);                 	//切换库
select database();          	//显示当前所在的库
show tables;                	//显示已有的表

使用SQL(结构化查询语言)命令的使用规则和分类:
  1.每条命令必须以;(分号)结束或分隔
  2.命令不区分大小写(密码和变量除外)
  3.不支持tab自动补全数据库操作:
  4.\c可以废弃当前的命令

常用SQL的操作指令
  1.DDL数据定义语言   (create  alter  drop)
  2.DML数据操作语言   (insert  update  delete)
  3.DCL数据控制语言   (grant  remoke)
  4.DTL数据事物语言   (commit  rollback  savepoint)

数据表:

表必须在库里创建

create database md1;         //创建md1库
create table md1.student(    //在md1库中创建student表
name char(15),               //第一个字段名为name,最多15个字符
sex char(10),                //第二个字段名为sex,最多10个字符
age int,                     //第三个字段名为age,只能为整数
tel char(11)                 //第四个字段名为tel,最多11个字符
);




###########################################################

1.临时和永久设置密码验证策略为只验证长度的命令分别是什么?
2.MySQL的主配置文件,数据库目录,端口号,进程名,传输协议,进程所有者,进程所属组分别是啥?
3.显示已有的库,切换库,显示当前所在的库,创建新库,显示已有的表,删除库的命令分别是啥?
4.查看表结构,查看表记录,删除表的命令分别是啥?
5.查看表记录,插入表记录,修改表记录,删除表记录的命令分别是啥?



1. 1)临时:mysql> set global validate_password_policy=0; 
    2)永久: vim  /etc/my.cnf
  validate_password_policy=0 
2.主配置文件   /etc/my.cnf
  数据库目录    /var/lib/mysql
  默认端口号   3306
   进程名         mysqld
  传输协议       TCP
  进程所有者     mysql
  进程所属组     mysql
3.Show    databases;      //显示已有的库
  Use  库名;                            //切换库
  Select   database();    //显示当前所在的库
  Create  database  库名;    //创建新库
  Show   tables;          //显示已有的表
  Drop    database  库名；  //删除库
4.  Desc   表名;                         //查看表结构
    Select   *  from   表名； //查看表记录
    Drop  table  表名;              //删除表
5.  Insert   into  表名   values(值列表);  //插入表记录
    Update 表名  set  字段=值;                        //修改表记录  
    Delete  from   表名;                                //删除表记录

###########################################################

3.mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| db1                |
| db2                |
| hao                |
| hao2               |
| lujiawen           |
| mysql              |
| performance_schema |
| studb              |
| sys                |
| yy                 |
+--------------------+
11 rows in set (0.08 sec)

mysql> desc db2;
ERROR 1046 (3D000): No database selected
mysql> use db2;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> 
mysql> select database();
+------------+
| database() |
+------------+
| db2        |
+------------+
1 row in set (0.00 sec)

mysql> show table db2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'db2' at line 1
mysql> show table db2.t9;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'db2.t9' at line 1
mysql> show table db2.t9;







mysql> desc db2.t9;
ERROR 1146 (42S02): Table 'db2.t9' doesn't exist
mysql> desc db2.t10;
ERROR 1146 (42S02): Table 'db2.t10' doesn't exist
mysql> desc db2.t8;
+-------+--------------------+------+-----+---------+-------+
| Field | Type               | Null | Key | Default | Extra |
+-------+--------------------+------+-----+---------+-------+
| name  | char(14)           | NO   |     |         |       |
| class | char(17)           | YES  |     | nsd1000 |       |
| age   | tinyint(2)         | NO   |     | 19      |       |
| sex   | enum('boy','girl') | NO   |     | boy     |       |
+-------+--------------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> show tables;
+---------------+
| Tables_in_db2 |
+---------------+
| dogperson     |
| stuinfo       |
| t11111        |
| t2            |
| t5            |
| t7            |
| t8            |
+---------------+
7 rows in set (0.00 sec)

mysql> create index aaa on stuinfo(name);
Query OK, 0 rows affected (0.23 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc stuinfo;
+------------+-----------------------------------+------+-----+---------+-------+
| Field      | Type                              | Null | Key | Default | Extra |
+------------+-----------------------------------+------+-----+---------+-------+
| stu_number | varchar(9)                        | YES  |     | NULL    |       |
| name       | char(14)                          | NO   | MUL |         |       |
| sex        | enum('boy','girl','no')           | NO   |     | boy     |       |
| class      | char(17)                          | YES  |     | nsd1000 |       |
| age        | int(2)                            | NO   |     | 19      |       |
| likes      | set('eat','sleeps','game','film') | YES  |     | NULL    |       |
+------------+-----------------------------------+------+-----+---------+-------+
6 rows in set (0.00 sec)

mysql> show index from stuinfo;
+---------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table   | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+---------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| stuinfo |          1 | aaa      |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |
+---------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
1 row in set (0.00 sec)

mysql>  show index from stuinfo\G; 
*************************** 1. row ***************************
        Table: stuinfo
   Non_unique: 1
     Key_name: aaa
 Seq_in_index: 1
  Column_name: name
    Collation: A
  Cardinality: 2
     Sub_part: NULL
       Packed: NULL
         Null: 
   Index_type: BTREE
      Comment: 
Index_comment: 
1 row in set (0.00 sec)

mysql> drop index aaa on  stuinfo;
Query OK, 0 rows affected (0.23 sec)alter
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc stuinfo;
+------------+-----------------------------------+------+-----+---------+-------+
| Field      | Type                              | Null | Key | Default | Extra |
+------------+-----------------------------------+------+-----+---------+-------+
| stu_number | varchar(9)               mysql> show  index from stuinfo;
Empty set (0.00 sec)

         | YES  |     | NULL    |       |
| name       | char(14)                          | NO   |     |         |       |
| sex        | enum('boy','girl','no')           | NO   |     | boy     |       |
| class      | char(17)                          | YES  |     | nsd1000 |       |
| age        | int(2)                            | NO   |     | 19      |       |
| likes      | set('eat','sleeps','game','film') | YES  |     | NULL    |       |
+------------+-----------------------------------+------+-----+---------+-------+
6 rows in set (0.00 sec)
mysql> show  index from stuinfo;
Empty set (0.00 sec)biaoji


两种方式设置主键
mysql> create table t10(stu_id char(9)  primary key , name char(10) , age  int(2));
Query OK, 0 rows affected (0.32 sec)

mysql> desc t10;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| stu_id | char(9)  | NO   | PRI | NULL    |       |
| name   | char(10) | YES  |     | NULL    |       |
| age    | int(2)   | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> create table t11(stu_id char(9) , name char(10) , age  int(2),primary key(stu_id));
Query OK, 0 rows affected (0.28 sec)

mysql> desc t11;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| stu_id | char(9)  | NO   | PRI | NULL    |       |
| name   | char(10) | YES  |     | NULL    |       |
| age    | int(2)   | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
3 rows in set (0.01 sec)


删除主键
mysql> alter  table t10 drop primary key;
Query OK, 0 rows affected (0.43 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc t10;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| stu_id | char(9)  | NO   |     | NULL    |       |
| name   | char(10) | YES  |     | NULL    |       |
| age    | int(2)   | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)


mysql> insert into t10  values("nsd","haio",21);                                             Query OK, 1 row affected (0.06 sec)

mysql> insert into t10  values("nsd","haiosa",21);
Query OK, 1 row affected (0.04 sec)

mysql> insert into t10  values("null","haiosa",21);
Query OK, 1 row affected (0.08 sec)

mysql> insert into t10  values(null,"haiosa",21);biaoji
ERROR 1048 (23000): Column 'stu_id' cannot be null
mysql> desc t10;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| stu_id | char(9)  | NO   |     | NULL    |       |
| name   | char(10) | YES  |     | NULL    |       |
| age    | int(2)   | YES  |     | NULL    |       |ho
+--------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> insert into t10  values("nsd","haiosa",21);
Query OK, 1 row affected (0.04 sec)

mysql> select * from  t10;
+--------+--------+------+
| stu_id | name   | age  |
+--------+--------+------+
| nsd    | haio   |   21 |
| nsd    | haiosa |   21 |
| null   | haiosa |   21 |
| nsd    | haiosa |   21 |
+--------+--------+------+
4 rows in set (0.00 sec)


在已经主键里创建主键字段

delete  from  t10;
  alter table t10 add primary key (stu_id);
desc t10;

mysql> delete  from  t10;
Query OK, 4 rows affected (0.04 sec)

mysql> desc t10;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |
+--------+----------+------+-----+---------+-------+
| stu_id | char(9)  | NO   |     | NULL    |       |
| name   | char(10) | YES  |     | NULL    |       |
| age    | int(2)   | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> select * from  t10;
Empty set (0.00 sec)

mysql> alter table t10 add primary key (stu_id);
Query OK, 0 rows affected (0.45 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc t10;
+--------+----------+------+-----+---------+-------+
| Field  | Type     | Null | Key | Default | Extra |                                 
+--------+----------+------+-----+---------+-------+
| stu_id | char(9)  | NO   | PRI | NULL    |       |
| name   | char(10) | YES  |     | NULL    |       |
| age    | int(2)   | YES  |     | NULL    |       |
+--------+----------+------+-----+---------+-------+
3 rows in set (0.00 sec)

创建复合主键:表中的多个字段一起做主键,赋值时,主键字段的值不同时重复

create table t13(
name char(15),
class char(15),
pay enum("yes","no"),
primary key (name,class)
);
mysql> create table t13(
    -> name char(15),
    -> class char(15),
    -> pay enum("yes","no"),
    -> primary key (name,class)
    -> );
Query OK, 0 rows affected (0.32 sec)

mysql> desc t13;
+-------+------------------+------+-----+---------+-------+
| Field | Type             | Null | Key | Default | Extra |
+-------+------------------+------+-----+---------+-------+
| name  | char(15)         | NO   | PRI | NULL    |       |
| class | char(15)         | NO   | PRI | NULL    |       |
| pay   | enum('yes','no') | YES  |     | NULL    |       |
+-------+------------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

但是不能下列方式创建复合主键
create table t13(
name char(15) primary key,
class char(15) primary key,
pay enum("yes","no")
);

PRI   PRImysql> create table t13(
    -> name char(15) primary key,
    -> class char(15) primary key,
    -> pay enum("yes","no")
    -> );
ERROR 1068 (42000): Multiple primary key defined

mysql> insert  into  t13 values("bob","nsd1804","yes");
Query OK, 1 row affected (0.06 sec)

mysql> insert  into  t13 values("bob","nsd1805","yes");
Query OK, 1 row affected (0.05 sec)

mysql> insert  into  t13 values("bob","nsd1804","no");
ERROR 1062 (23000): Duplicate entry 'bob-nsd1804' for key 'PRIMARY'
mysql> insert  into  t13 values("lucy","nsd1804","no");
Query OK, 1 row affected (0.07 sec)

mysql> select  *  from t13;
+------+---------+------+
| name | class   | pay  |
+------+---------+------+
| bob  | nsd1804 | yes  |
| bob  | nsd1805 | yes  |
| lucy | nsd1804 | no   |
+------+---------+------+
3 rows in set (0.00 sec)

name  class      pay
bob   nsd1804    yes 
bob   nsd1804    no
lucy  nsd1805    yes

删除复合键

alter table t12 drop primary key;

在已经有表中创建复合主键

delete *  from  t12;
alter table t12 add primary key (name,class);

##########################################################################

2018年 07月 12日 星期四 09:05:08 CST

批量更新表字段值

mysql> select * from t11;
+--------+-------+------+
| stu_id | name  | age  |
+--------+-------+------+
| hao    | nihao |   55 |
+--------+-------+------+
1 row in set (0.00 sec)

mysql> update t11 set stu_id="good"  where age=55;
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from t11;
+--------+-------+------+
| stu_id | name  | age  |
+--------+-------+------+
| good   | nihao |   55 |
+--------+-------+------+
1 row in set (0.00 sec)

mysql> update t11 set stu_id="good",name="hhhhhh"  where age=55;
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from t11;
+--------+--------+------+
| stu_id | name   | age  |
+--------+--------+------+
| good   | hhhhhh |   55 |
+--------+--------+------+
1 row in set (0.00 sec)

mysql> update t11 set stu_id="goodgood",name="haohaohaohaoah"  where age=55;
ERROR 1406 (22001): Data too long for column 'name' at row 1
mysql> update t11 set stu_id="goodgood",name="haohao"  where age=55;
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from t11;
+----------+--------+------+
| stu_id   | name   | age  |
+----------+--------+------+
| goodgood | haohao |   55 |
+----------+--------+------+
1 row in set (0.00 sec)

auto_increment:

mysql> create table t( id  int(2)  primary key auto_increment,  name char(15) not null ,  age tinyint(2)  unsigned  default 19, pay  float(7,2) default 26800);
Query OK, 0 rows affected (1.37 sec)


mysql> desc t;
+-------+---------------------+------+-----+----------+----------------+
| Field | Type                | Null | Key | Default  | Extra          |
+-------+---------------------+------+-----+----------+----------------+
| id    | int(2)              | NO   | PRI | NULL     | auto_increment |
| name  | char(15)            | NO   |     | NULL     |                |
| age   | tinyint(2) unsigned | YES  |     | 19       |                |
| pay   | float(7,2)          | YES  |     | 26800.00 |                |
+-------+---------------------+------+-----+----------+----------------+
4 rows in set (0.01 sec)

mysql> insert into t(name,age,pay)  values("tom",21,18888);
Query OK, 1 row affected (0.05 sec)


mysql> select *  from  t;
+----+------+------+----------+
| id | name | age  | pay      |
+----+------+------+----------+
|  1 | tom  |   21 | 18888.00 |
+----+------+------+----------+
1 row in set (0.00 sec)

mysql> insert into t(name,age,pay)  values("harry",26,18888);
Query OK, 1 row affected (0.07 sec)

mysql> select *  from  t;
+----+-------+------+----------+
| id | name  | age  | pay      |
+----+-------+------+----------+
|  1 | tom   |   21 | 18888.00 |
|  2 | harry |   26 | 18888.00 |
+----+-------+------+----------+
2 rows in set (0.00 sec)


mysql> insert into t values(7,"harry",26,18888);
Query OK, 1 row affected (0.05 sec)
+-------+---------------------+------+-----+----------+----------------+
| Field | Type                | Null | Key | Default  | Extra          |
+-------+---------------------+------+-----+----------+----------------+
| id    | int(2)              | NO   | PRI | NULL     | auto_increment |
| name  | char(15)            | NO   |     | NULL     |                |
| age   | tinyint(2) unsigned | YES  |     | 19       |                |
| pay   | float(7,2)          | YES  |     | 26800.00 |                |
+-------+---------------------+------+-----+----------+----------------+
4 rows in set (0.01 sec)

mysql> insert into t(name,age,pay)  values("tom",21,18888);
Query OK, 1 row affected (0.05 sec)

mysql> desc t;
+-------+---------------------+------+-----+----------+----------------+
| Field | Type                | Null | Key | Default  | Extra          |
+-------+---------------------+------+-----+----------+----------------+
| id    | int(2)              | NO   | PRI | NULL     | auto_increment |
| name  | char(15)            | NO   |     | NULL     |                |
| age   | tinyint(2) unsigned | YES  |     | 19       |                |
| pay   | float(7,2)          | YES  |     | 26800.00 |                |
+-------+---------------------+------+-----+----------+----------------+
4 rows in set (0.00 sec)

mysql> select *  from  t;
+----+-------+------+----------+
| id | name  | age  | pay      |
+----+-------+------+----------+
|  1 | tom   |   21 | 18888.00 |
|  2 | harry |   26 | 18888.00 |
|  7 | harry |   26 | 18888.00 |
+----+-------+------+----------+
3 rows in set (0.01 sec)

mysql> insert into t(name,age,pay)  values("ok",16,18888);
Query OK, 1 row affected (0.05 sec)

mysql> select *  from  t;
+----+-------+------+----------+
| id | name  | age  | pay      |
+----+-------+------+----------+
|  1 | tom   |   21 | 18888.00 |
|  2 | harry |   26 | 18888.00 |
|  7 | harry |   26 | 18888.00 |
|  8 | ok    |   16 | 18888.00 |
+----+-------+------+----------+
4 rows in set (0.00 sec)

mysql> insert into t values(null,"harry",26,18888);
Query OK, 1 row affected (0.05 sec)

mysql> select *  from  t;
+----+-------+------+----------+
| id | name  | age  | pay      |
+----+-------+------+----------+
|  1 | tom   |   21 | 18888.00 |
|  2 | harry |   26 | 18888.00 |
|  7 | harry |   26 | 18888.00 |
|  8 | ok    |   16 | 18888.00 |
|  9 | harry |   26 | 18888.00 |
+----+-------+------+----------+
5 rows in set (0.01 sec)

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

外键:让当前表字段的值在另一个表中字段值的范围内选择

使用外键的条件:
-表的存储引擎必须是innodb
-字段类型要一致
-被参照字段必须要是索引类型的一种 (primary key)


mysql> create table  yginfo (yg_id int(2) primary key auto_increment, name char(15))engine=innodb;
Query OK, 0 rows affected (0.61 sec)

mysql> desc yginfo;
+-------+----------+------+-----+---------+----------------+
| Field | Type     | Null | Key | Default | Extra          |
+-------+----------+------+-----+---------+----------------+
| yg_id | int(2)   | NO   | PRI | NULL    | auto_increment |
| name  | char(15) | YES  |     | NULL    |                |
+-------+----------+------+-----+---------+----------------+
2 rows in set (0.00 sec)


mysql> insert into yginfo(name) values("bob");
Query OK, 1 row affected (0.33 sec)

mysql> select *  from yginfo;
+-------+------+
| yg_id | name |
+-------+------+
|     1 | bob  |
+-------+------+
1 row in set (0.00 sec)

mysql> insert into yginfo(name) values("bob");
Query OK, 1 row affected (0.07 sec)

mysql> select *  from yginfo;
+-------+------+
| yg_id | name |
+-------+------+
|     1 | bob  |
|     2 | bob  |
+-------+------+
2 rows in set (0.00 sec)

mysql> insert into yginfo(name) values("lucy");
Query OK, 1 row affected (0.08 sec)

mysql> select *  from yginfo;
+-------+------+
| yg_id | name |
+-------+------+
|     1 | bob  |
|     2 | bob  |
|     3 | lucy |
+-------+------+
3 rows in set (0.00 sec)

mysql> create table gztab(gz_id int(2),pay float(7,2),foreign  key(gz_id)  references yginfo(yg_id) on delete cascade  on  update cascade)engine=innodb;
Query OK, 0 rows affected (0.30 sec)



mysql> desc gztab;
+-------+------------+------+-----+---------+-------+
| Field | Type       | Null | Key | Default | Extra |
+-------+------------+------+-----+---------+-------+
| gz_id | int(2)     | YES  | MUL | NULL    |       |
| pay   | float(7,2) | YES  |     | NULL    |       |
+-------+------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

mysql> show  create  table gztab;
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                                                                                                                               |
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| gztab | CREATE TABLE `gztab` (
  `gz_id` int(2) DEFAULT NULL,
  `pay` float(7,2) DEFAULT NULL,
  KEY `gz_id` (`gz_id`),
  CONSTRAINT `gztab_ibfk_1` FOREIGN KEY (`gz_id`) REFERENCES `yginfo` (`yg_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)


mysql> select *  from gztab;
Empty set (0.00 sec)


mysql> insert into gztab values (1,20000);
Query OK, 1 row affected (0.05 sec)

mysql> select * from gztab;
+-------+----------+
| gz_id | pay      |
+-------+----------+
|     1 | 20000.00 |
+-------+----------+
1 row in set (0.00 sec)

mysql> insert into gztab values (2,27000);
Query OK, 1 row affected (0.04 sec)

mysql> insert into gztab values (3,29900);
Query OK, 1 row affected (0.05 sec)

mysql> select * from gztab;
+-------+----------+
| gz_id | pay      |
+-------+----------+
|     1 | 20000.00 |
|     2 | 27000.00 |
|     3 | 29900.00 |
+-------+----------+
3 rows in set (0.00 sec)

mysql> insert into gztab values (4,89900);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`db3`.`gztab`, CONSTRAINT `gztab_ibfk_1` FOREIGN KEY (`gz_id`) REFERENCES `yginfo` (`yg_id`) ON DELETE CASCADE ON UPDATE CASCADE)


mysql> update yginfo set yg_id=7  where yg_id=2;
Query OK, 1 row affected (0.12 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select *  from  yginfo;
+-------+------+
| yg_id | name |
+-------+------+
|     1 | bob  |
|     3 | lucy |
|     7 | bob  |
+-------+------+
3 rows in set (0.00 sec)


mysql> select *  from  gztab;
+-------+----------+
| gz_id | pay      |
+-------+----------+
|     1 | 20000.00 |
|     7 | 27000.00 |
|     3 | 29900.00 |
+-------+----------+
3 rows in set (0.00 sec)

mysql> delete from yginfo where yg_id=3;     //Delete  from   表名;                    //删除表记录
Query OK, 1 row affected (0.06 sec)

mysql> select *  from  yginfo;
+-------+------+
| yg_id | name |
+-------+------+
|     1 | bob  |
|     7 | bob  |
+-------+------+
2 rows in set (0.00 sec)

mysql> select *  from  gztab;
+-------+----------+
| gz_id | pay      |
+-------+----------+
|     1 | 20000.00 |
|     7 | 27000.00 |
+-------+----------+
2 rows in set (0.00 sec)

######################################################


数据导入:把系统文件的内容存储到数据库服务器的表里. 有格式规律


数据导出:把数据库服务器的表里的记录存储到习题文件里


导入,导出数据文件存储路径  默认是 /var/lib/mysql-files


mysql>show variables like  "secure_file_priv";
 ----------------------->>/var/lib/mysql-files

mysql> show variables  like "secure_file_priv";
+------------------+-----------------------+
| Variable_name    | Value                 |
+------------------+-----------------------+
| secure_file_priv | /var/lib/mysql-files/ |
+------------------+-----------------------+
1 row in set (0.00 sec)



修改默认文件存储路径
[root@host50 ~]# mkdir  /mydata
[root@host50 ~]# chown  mysql  /mydata
[root@host50 ~]# vim /etc/my.cnf
[mysqld]
secure_file_priv="/mydata"
:x
systemctl  restart  mysqld

mysql> show variables  like "secure_file_priv";
+------------------+----------+
| Variable_name    | Value    |
+------------------+----------+
| secure_file_priv | /mydata/ |
+------------------+----------+
1 row in set (0.01 sec)

数据导入:
把系统文件拷贝指定的目录下
创建存储文件内容的表
导入数据(;命令格式)


数据库里执行命令加 system:
mysql> system  cp  /etc/passwd  /mydata
mysql> system ls  /mydata
passwd

create table db3.user(
name char(50),
password char(1),
uid int(2),
gid int(2),
comment varchar(150),
homedir  char(150),
shell char(150),
index(name)
);


mysql> load  data infile "/mydata/passwd" into table db3.user fields terminated by ":"  lines terminated by "\n";


mysql>  load  data infile "/mydata/passwd" into table db3.user fields terminated by ":"  lines terminated by "\n";
Query OK, 42 rows affected (0.07 sec)
Records: 42  Deleted: 0  Skipped: 0  Warnings: 0

mysql> select  *  from  user;
+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| root                | x        |     0 |     0 | root                                                            | /root                     | /bin/bash      |
| bin                 | x        |     1 |     1 | bin                                                             | /bin                      | /sbin/nologin  |
| daemon              | x        |     2 |     2 | daemon                                                          | /sbin                     | /sbin/nologin  |
| adm                 | x        |     3 |     4 | adm                                                             | /var/adm                  | /sbin/nologin  |
| lp                  | x        |     4 |     7 | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
| sync                | x        |     5 |     0 | sync                                                            | /sbin                     | /bin/sync      |
| shutdown            | x        |     6 |     0 | shutdown                                                        | /sbin                     | /sbin/shutdown |
| halt                | x        |     7 |     0 | halt                                                            | /sbin                     | /sbin/halt     |
| mail                | x        |     8 |    12 | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| operator            | x        |    11 |     0 | operator                                                        | /root                     | /sbin/nologin  |
| games               | x        |    12 |   100 | games                                                           | /usr/games                | /sbin/nologin  |
| ftp                 | x        |    14 |    50 | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| nobody              | x        |    99 |    99 | Nobody                                                          | /                         | /sbin/nologin  |
| systemd-network     | x        |   192 |   192 | systemd Network Management                                      | /                         | /sbin/nologin  |
| dbus                | x        |    81 |    81 | System message bus                                              | /                         | /sbin/nologin  |
| polkitd             | x        |   999 |   998 | User for polkitd                                                | /                         | /sbin/nologin  |
| libstoragemgmt      | x        |   998 |   996 | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| rpc                 | x        |    32 |    32 | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| colord              | x        |   997 |   995 | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| saslauth            | x        |   996 |    76 | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| abrt                | x        |   173 |   173 |                                                                 | /etc/abrt                 | /sbin/nologin  |
| rtkit               | x        |   172 |   172 | RealtimeKit                                                     | /proc                     | /sbin/nologin  |
| radvd               | x        |    75 |    75 | radvd user                                                      | /                         | /sbin/nologin  |
| chrony              | x        |   995 |   993 |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| tss                 | x        |    59 |    59 | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| usbmuxd             | x        |   113 |   113 | usbmuxd user                                                    | /                         | /sbin/nologin  |
| geoclue             | x        |   994 |   991 | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| qemu                | x        |   107 |   107 | qemu user                                                       | /                         | /sbin/nologin  |
| rpcuser             | x        |    29 |    29 | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| setroubleshoot      | x        |   993 |   990 |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| pulse               | x        |   171 |   171 | PulseAudio System Daemon                                        | /var/run/pulse            | /sbin/nologin  |
| gdm                 | x        |    42 |    42 |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| gnome-initial-setup | x        |   992 |   987 |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| sshd                | x        |    74 |    74 | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| avahi               | x        |    70 |    70 | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| postfix             | x        |    89 |    89 |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| ntp                 | x        |    38 |    38 |                                                                 | /etc/ntp                  | /sbin/nologin  |
| tcpdump             | x        |    72 |    72 |                                                                 | /                         | /sbin/nologin  |
| lisi                | x        |  1000 |  1000 | lisi                                                            | /home/lisi                | /bin/bash      |
| mysql               | x        |    27 |    27 | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| apache              | x        |    48 |    48 | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
42 rows in set (0.01 sec)

 
mysql> alter  table  user  add id int(5) primary key auto_increment first;
Query OK, 0 rows affected (0.68 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> select  *  from  user;
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| id | name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
|  1 | root                | x        |     0 |     0 | root                                                            | /root                     | /bin/bash      |
|  2 | bin                 | x        |     1 |     1 | bin                                                             | /bin                      | /sbin/nologin  |
|  3 | daemon              | x        |     2 |     2 | daemon                                                          | /sbin                     | /sbin/nologin  |
|  4 | adm                 | x        |     3 |     4 | adm                                                             | /var/adm                  | /sbin/nologin  |
|  5 | lp                  | x        |     4 |     7 | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
|  6 | sync                | x        |     5 |     0 | sync                                                            | /sbin                     | /bin/sync      |
|  7 | shutdown            | x        |     6 |     0 | shutdown                                                        | /sbin                     | /sbin/shutdown |
|  8 | halt                | x        |     7 |     0 | halt                                                            | /sbin                     | /sbin/halt     |
|  9 | mail                | x        |     8 |    12 | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| 10 | operator            | x        |    11 |     0 | operator                                                        | /root                     | /sbin/nologin  |
| 11 | games               | x        |    12 |   100 | games                                                           | /usr/games                | /sbin/nologin  |
| 12 | ftp                 | x        |    14 |    50 | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| 13 | nobody              | x        |    99 |    99 | Nobody                                                          | /                         | /sbin/nologin  |
| 14 | systemd-network     | x        |   192 |   192 | systemd Network Management                                      | /                         | /sbin/nologin  |
| 15 | dbus                | x        |    81 |    81 | System message bus                                              | /                         | /sbin/nologin  |
| 16 | polkitd             | x        |   999 |   998 | User for polkitd                                                | /                         | /sbin/nologin  |
| 17 | libstoragemgmt      | x        |   998 |   996 | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| 18 | rpc                 | x        |    32 |    32 | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| 19 | colord              | x        |   997 |   995 | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| 20 | saslauth            | x        |   996 |    76 | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| 21 | abrt                | x        |   173 |   173 |                                                                 | /etc/abrt                 | /sbin/nologin  |
| 22 | rtkit               | x        |   172 |   172 | RealtimeKit                                                     | /proc                     | /sbin/nologin  |
| 23 | radvd               | x        |    75 |    75 | radvd user                                                      | /                         | /sbin/nologin  |
| 24 | chrony              | x        |   995 |   993 |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| 25 | tss                 | x        |    59 |    59 | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| 26 | usbmuxd             | x        |   113 |   113 | usbmuxd user                                                    | /                         | /sbin/nologin  |
| 27 | geoclue             | x        |   994 |   991 | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| 28 | qemu                | x        |   107 |   107 | qemu user                                                       | /                         | /sbin/nologin  |
| 29 | rpcuser             | x        |    29 |    29 | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| 30 | nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| 31 | setroubleshoot      | x        |   993 |   990 |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| 32 | pulse               | x        |   171 |   171 | PulseAudio System Daemon                                        | /var/run/pulse            | /sbin/nologin  |
| 33 | gdm                 | x        |    42 |    42 |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| 34 | gnome-initial-setup | x        |   992 |   987 |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| 35 | sshd                | x        |    74 |    74 | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| 36 | avahi               | x        |    70 |    70 | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| 37 | postfix             | x        |    89 |    89 |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| 38 | ntp                 | x        |    38 |    38 |                                                                 | /etc/ntp                  | /sbin/nologin  |
| 39 | tcpdump             | x        |    72 |    72 |                                                                 | /                         | /sbin/nologin  |
| 40 | lisi                | x        |  1000 |  1000 | lisi                                                            | /home/lisi                | /bin/bash      |
| 41 | mysql               | x        |    27 |    27 | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| 42 | apache              | x        |    48 |    48 | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
42 rows in set (0.01 sec)

数据导出
mysql>  sql

select *  from user into outfile "/mydata/t1.txt";

select *  from user into outfile "/mydata/t2.txt" fields terminated by "#";

select *  from user into outfile "/mydata/t2.txt" fields terminated by "#" lines terminated by "!!!!!!";


mysql> select *  from user into outfile "/mydata/t1.txt";
Query OK, 42 rows affected (0.00 sec)

mysql> system  cat  /mydata/t1.txt
1	root	x	0	0	root	/root	/bin/bash
2	bin	x	1	1	bin	/bin	/sbin/nologin
3	daemon	x	2	2	daemon	/sbin	/sbin/nologin
4	adm	x	3	4	adm	/var/adm	/sbin/nologin
5	lp	x	4	7	lp	/var/spool/lpd	/sbin/nologin
6	sync	x	5	0	sync	/sbin	/bin/sync
7	shutdown	x	6	0	shutdown	/sbin	/sbin/shutdown
8	halt	x	7	0	halt	/sbin	/sbin/halt
9	mail	x	8	12	mail	/var/spool/mail	/sbin/nologin
10	operator	x	11	0	operator	/root	/sbin/nologin
11	games	x	12	100	games	/usr/games	/sbin/nologin
12	ftp	x	14	50	FTP User	/var/ftp	/sbin/nologin
13	nobody	x	99	99	Nobody	/	/sbin/nologin
14	systemd-network	x	192	192	systemd Network Management	/	/sbin/nologin
15	dbus	x	81	81	System message bus	/	/sbin/nologin
16	polkitd	x	999	998	User for polkitd	/	/sbin/nologin
17	libstoragemgmt	x	998	996	daemon account for libstoragemgmt	/var/run/lsm	/sbin/nologin
18	rpc	x	32	32	Rpcbind Daemon	/var/lib/rpcbind	/sbin/nologin
19	colord	x	997	995	User for colord	/var/lib/colord	/sbin/nologin
20	saslauth	x	996	76	Saslauthd user	/run/saslauthd	/sbin/nologin
21	abrt	x	173	173		/etc/abrt	/sbin/nologin
22	rtkit	x	172	172	RealtimeKit	/proc	/sbin/nologin
23	radvd	x	75	75	radvd user	/	/sbin/nologin
24	chrony	x	995	993		/var/lib/chrony	/sbin/nologin
25	tss	x	59	59	Account used by the trousers package to sandbox the tcsd daemon	/dev/null	/sbin/nologin
26	usbmuxd	x	113	113	usbmuxd user	/	/sbin/nologin
27	geoclue	x	994	991	User for geoclue	/var/lib/geoclue	/sbin/nologin
28	qemu	x	107	107	qemu user	/	/sbin/nologin
29	rpcuser	x	29	29	RPC Service User	/var/lib/nfs	/sbin/nologin
30	nfsnobody	x	65534	65534	Anonymous NFS User	/var/lib/nfs	/sbin/nologin
31	setroubleshoot	x	993	990		/var/lib/setroubleshoot	/sbin/nologin
32	pulse	x	171	171	PulseAudio System Daemon	/var/run/pulse	/sbin/nologin
33	gdm	x	42	42		/var/lib/gdm	/sbin/nologin
34	gnome-initial-setup	x	992	987		/run/gnome-initial-setup/	/sbin/nologin
35	sshd	x	74	74	Privilege-separated SSH	/var/empty/sshd	/sbin/nologin
36	avahi	x	70	70	Avahi mDNS/DNS-SD Stack	/var/run/avahi-daemon	/sbin/nologin
37	postfix	x	89	89		/var/spool/postfix	/sbin/nologin
38	ntp	x	38	38		/etc/ntp	/sbin/nologin
39	tcpdump	x	72	72		/	/sbin/nologin
40	lisi	x	1000	1000	lisi	/home/lisi	/bin/bash
41	mysql	x	27	27	MySQL Server	/var/lib/mysql	/bin/false
42	apache	x	48	48	Apache	/usr/share/httpd	/sbin/nologin


mysql> select *  from user into outfile "/mydata/t2.txt" fields terminated by "#";
Query OK, 42 rows affected (0.00 sec)

mysql> system  cat  /mydata/t2.txt
1#root#x#0#0#root#/root#/bin/bash
2#bin#x#1#1#bin#/bin#/sbin/nologin
3#daemon#x#2#2#daemon#/sbin#/sbin/nologin
4#adm#x#3#4#adm#/var/adm#/sbin/nologin
5#lp#x#4#7#lp#/var/spool/lpd#/sbin/nologin
6#sync#x#5#0#sync#/sbin#/bin/sync
7#shutdown#x#6#0#shutdown#/sbin#/sbin/shutdown
8#halt#x#7#0#halt#/sbin#/sbin/halt
9#mail#x#8#12#mail#/var/spool/mail#/sbin/nologin
10#operator#x#11#0#operator#/root#/sbin/nologin
11#games#x#12#100#games#/usr/games#/sbin/nologin
12#ftp#x#14#50#FTP User#/var/ftp#/sbin/nologin
13#nobody#x#99#99#Nobody#/#/sbin/nologin
14#systemd-network#x#192#192#systemd Network Management#/#/sbin/nologin
15#dbus#x#81#81#System message bus#/#/sbin/nologin
16#polkitd#x#999#998#User for polkitd#/#/sbin/nologin
17#libstoragemgmt#x#998#996#daemon account for libstoragemgmt#/var/run/lsm#/sbin/nologin
18#rpc#x#32#32#Rpcbind Daemon#/var/lib/rpcbind#/sbin/nologin
19#colord#x#997#995#User for colord#/var/lib/colord#/sbin/nologin
20#saslauth#x#996#76#Saslauthd user#/run/saslauthd#/sbin/nologin
21#abrt#x#173#173##/etc/abrt#/sbin/nologin
22#rtkit#x#172#172#RealtimeKit#/proc#/sbin/nologin
23#radvd#x#75#75#radvd user#/#/sbin/nologin
24#chrony#x#995#993##/var/lib/chrony#/sbin/nologin
25#tss#x#59#59#Account used by the trousers package to sandbox the tcsd daemon#/dev/null#/sbin/nologin
26#usbmuxd#x#113#113#usbmuxd user#/#/sbin/nologin
27#geoclue#x#994#991#User for geoclue#/var/lib/geoclue#/sbin/nologin
28#qemu#x#107#107#qemu user#/#/sbin/nologin
29#rpcuser#x#29#29#RPC Service User#/var/lib/nfs#/sbin/nologin
30#nfsnobody#x#65534#65534#Anonymous NFS User#/var/lib/nfs#/sbin/nologin
31#setroubleshoot#x#993#990##/var/lib/setroubleshoot#/sbin/nologin
32#pulse#x#171#171#PulseAudio System Daemon#/var/run/pulse#/sbin/nologin
33#gdm#x#42#42##/var/lib/gdm#/sbin/nologin
34#gnome-initial-setup#x#992#987##/run/gnome-initial-setup/#/sbin/nologin
35#sshd#x#74#74#Privilege-separated SSH#/var/empty/sshd#/sbin/nologin
36#avahi#x#70#70#Avahi mDNS/DNS-SD Stack#/var/run/avahi-daemon#/sbin/nologin
37#postfix#x#89#89##/var/spool/postfix#/sbin/nologin
38#ntp#x#38#38##/etc/ntp#/sbin/nologin
39#tcpdump#x#72#72##/#/sbin/nologin
40#lisi#x#1000#1000#lisi#/home/lisi#/bin/bash
41#mysql#x#27#27#MySQL Server#/var/lib/mysql#/bin/false
42#apache#x#48#48#Apache#/usr/share/httpd#/sbin/nologin

mysql> select *  from user into outfile "/mydata/t3.txt" fields terminated by "#" lines terminated by "!!!!!!";
Query OK, 42 rows affected (0.00 sec)

mysql> system  cat  /mydata/t3.txt
1#root#x#0#0#root#/root#/bin/bash!!!!!!2#bin#x#1#1#bin#/bin#/sbin/nologin!!!!!!3#daemon#x#2#2#daemon#/sbin#/sbin/nologin!!!!!!4#adm#x#3#4#adm#/var/adm#/sbin/nologin!!!!!!5#lp#x#4#7#lp#/var/spool/lpd#/sbin/nologin!!!!!!6#sync#x#5#0#sync#/sbin#/bin/sync!!!!!!7#shutdown#x#6#0#shutdown#/sbin#/sbin/shutdown!!!!!!8#halt#x#7#0#halt#/sbin#/sbin/halt!!!!!!9#mail#x#8#12#mail#/var/spool/mail#/sbin/nologin!!!!!!10#operator#x#11#0#operator#/root#/sbin/nologin!!!!!!11#games#x#12#100#games#/usr/games#/sbin/nologin!!!!!!12#ftp#x#14#50#FTP User#/var/ftp#/sbin/nologin!!!!!!13#nobody#x#99#99#Nobody#/#/sbin/nologin!!!!!!14#systemd-network#x#192#192#systemd Network Management#/#/sbin/nologin!!!!!!15#dbus#x#81#81#System message bus#/#/sbin/nologin!!!!!!16#polkitd#x#999#998#User for polkitd#/#/sbin/nologin!!!!!!17#libstoragemgmt#x#998#996#daemon account for libstoragemgmt#/var/run/lsm#/sbin/nologin!!!!!!18#rpc#x#32#32#Rpcbind Daemon#/var/lib/rpcbind#/sbin/nologin!!!!!!19#colord#x#997#995#User for colord#/var/lib/colord#/sbin/nologin!!!!!!20#saslauth#x#996#76#Saslauthd user#/run/saslauthd#/sbin/nologin!!!!!!21#abrt#x#173#173##/etc/abrt#/sbin/nologin!!!!!!22#rtkit#x#172#172#RealtimeKit#/proc#/sbin/nologin!!!!!!23#radvd#x#75#75#radvd user#/#/sbin/nologin!!!!!!24#chrony#x#995#993##/var/lib/chrony#/sbin/nologin!!!!!!25#tss#x#59#59#Account used by the trousers package to sandbox the tcsd daemon#/dev/null#/sbin/nologin!!!!!!26#usbmuxd#x#113#113#usbmuxd user#/#/sbin/nologin!!!!!!27#geoclue#x#994#991#User for geoclue#/var/lib/geoclue#/sbin/nologin!!!!!!28#qemu#x#107#107#qemu user#/#/sbin/nologin!!!!!!29#rpcuser#x#29#29#RPC Service User#/var/lib/nfs#/sbin/nologin!!!!!!30#nfsnobody#x#65534#65534#Anonymous NFS User#/var/lib/nfs#/sbin/nologin!!!!!!31#setroubleshoot#x#993#990##/var/lib/setroubleshoot#/sbin/nologin!!!!!!32#pulse#x#171#171#PulseAudio System Daemon#/var/run/pulse#/sbin/nologin!!!!!!33#gdm#x#42#42##/var/lib/gdm#/sbin/nologin!!!!!!34#gnome-initial-setup#x#992#987##/run/gnome-initial-setup/#/sbin/nologin!!!!!!35#sshd#x#74#74#Privilege-separated SSH#/var/empty/sshd#/sbin/nologin!!!!!!36#avahi#x#70#70#Avahi mDNS/DNS-SD Stack#/var/run/avahi-daemon#/sbin/nologin!!!!!!37#postfix#x#89#89##/var/spool/postfix#/sbin/nologin!!!!!!38#ntp#x#38#38##/etc/ntp#/sbin/nologin!!!!!!39#tcpdump#x#72#72##/#/sbin/nologin!!!!!!40#lisi#x#1000#1000#lisi#/home/lisi#/bin/bash!!!!!!41#mysql#x#27#27#MySQL Server#/var/lib/mysql#/bin/false!!!!!!42#apache#x#48#48#Apache#/usr/share/httpd#/sbin/nologin!!!!!!mysql> 

####################################################################################################################


添加一条新记录
insert into user values
(43,"ok","x",2000,2000,"student user","/home/ok","/bin/bahs");

mysql> insert into user values
    -> (43,"ok","x",2000,2000,"student user","/home/ok","/bin/bahs");
Query OK, 1 row affected (0.32 sec)

mysql> select  *  from user;
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| id | name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
|  1 | root                | x        |     0 |     0 | root                                                            | /root                     | /bin/bash      |
|  2 | bin                 | x        |     1 |     1 | bin                                                             | /bin                      | /sbin/nologin  |
|  3 | daemon              | x        |     2 |     2 | daemon                                                          | /sbin                     | /sbin/nologin  |
|  4 | adm                 | x        |     3 |     4 | adm                                                             | /var/adm                  | /sbin/nologin  |
|  5 | lp                  | x        |     4 |     7 | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
|  6 | sync                | x        |     5 |     0 | sync                                                            | /sbin                     | /bin/sync      |
|  7 | shutdown            | x        |     6 |     0 | shutdown                                                        | /sbin                     | /sbin/shutdown |
|  8 | halt                | x        |     7 |     0 | halt                                                            | /sbin                     | /sbin/halt     |
|  9 | mail                | x        |     8 |    12 | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| 10 | operator            | x        |    11 |     0 | operator                                                        | /root                     | /sbin/nologin  |
| 11 | games               | x        |    12 |   100 | games                                                           | /usr/games                | /sbin/nologin  |
| 12 | ftp                 | x        |    14 |    50 | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| 13 | nobody              | x        |    99 |    99 | Nobody                                                          | /                         | /sbin/nologin  |
| 14 | systemd-network     | x        |   192 |   192 | systemd Network Management                                      | /                         | /sbin/nologin  |
| 15 | dbus                | x        |    81 |    81 | System message bus                                              | /                         | /sbin/nologin  |
| 16 | polkitd             | x        |   999 |   998 | User for polkitd                                                | /                         | /sbin/nologin  |
| 17 | libstoragemgmt      | x        |   998 |   996 | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| 18 | rpc                 | x        |    32 |    32 | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| 19 | colord              | x        |   997 |   995 | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| 20 | saslauth            | x        |   996 |    76 | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| 21 | abrt                | x        |   173 |   173 |                                                                 | /etc/abrt                 | /sbin/nologin  |
| 22 | rtkit               | x        |   172 |   172 | RealtimeKit                                                     | /proc                     | /sbin/nologin  |
| 23 | radvd               | x        |    75 |    75 | radvd user                                                      | /                         | /sbin/nologin  |
| 24 | chrony              | x        |   995 |   993 |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| 25 | tss                 | x        |    59 |    59 | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| 26 | usbmuxd             | x        |   113 |   113 | usbmuxd user                                                    | /                         | /sbin/nologin  |
| 27 | geoclue             | x        |   994 |   991 | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| 28 | qemu                | x        |   107 |   107 | qemu user                                                       | /                         | /sbin/nologin  |
| 29 | rpcuser             | x        |    29 |    29 | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| 30 | nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| 31 | setroubleshoot      | x        |   993 |   990 |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| 32 | pulse               | x        |   171 |   171 | PulseAudio System Daemon                                        | /var/run/pulse            | /sbin/nologin  |
| 33 | gdm                 | x        |    42 |    42 |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| 34 | gnome-initial-setup | x        |   992 |   987 |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| 35 | sshd                | x        |    74 |    74 | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| 36 | avahi               | x        |    70 |    70 | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| 37 | postfix             | x        |    89 |    89 |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| 38 | ntp                 | x        |    38 |    38 |                                                                 | /etc/ntp                  | /sbin/nologin  |
| 39 | tcpdump             | x        |    72 |    72 |                                                                 | /                         | /sbin/nologin  |
| 40 | lisi                | x        |  1000 |  1000 | lisi                                                            | /home/lisi                | /bin/bash      |
| 41 | mysql               | x        |    27 |    27 | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| 42 | apache              | x        |    48 |    48 | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
| 43 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bahs      |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
43 rows in set (0.00 sec)


添加多条新记录
insert into user values
(44,"ok","x",2000,2000,"student user","/home/ok","/bin/bash"),
(45,"ok","x",2000,2000,"student user","/home/ok","/bin/bash"),
(46,"ok","x",2000,2000,"student user","/home/ok","/bin/bash");

mysql> insert into user values
    -> (44,"ok","x",2000,2000,"student user","/home/ok","/bin/bash"),
    -> (45,"ok","x",2000,2000,"student user","/home/ok","/bin/bash"),
    -> (46,"ok","x",2000,2000,"student user","/home/ok","/bin/bash");
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> select  *  from user;
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| id | name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
|  1 | root                | x        |     0 |     0 | root                                                            | /root                     | /bin/bash      |
|  2 | bin                 | x        |     1 |     1 | bin                                                             | /bin                      | /sbin/nologin  |
|  3 | daemon              | x        |     2 |     2 | daemon                                                          | /sbin                     | /sbin/nologin  |
|  4 | adm                 | x        |     3 |     4 | adm                                                             | /var/adm                  | /sbin/nologin  |
|  5 | lp                  | x        |     4 |     7 | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
|  6 | sync                | x        |     5 |     0 | sync                                                            | /sbin                     | /bin/sync      |
|  7 | shutdown            | x        |     6 |     0 | shutdown                                                        | /sbin                     | /sbin/shutdown |
|  8 | halt                | x        |     7 |     0 | halt                                                            | /sbin                     | /sbin/halt     |
|  9 | mail                | x        |     8 |    12 | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| 10 | operator            | x        |    11 |     0 | operator                                                        | /root                     | /sbin/nologin  |
| 11 | games               | x        |    12 |   100 | games                                                           | /usr/games                | /sbin/nologin  |
| 12 | ftp                 | x        |    14 |    50 | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| 13 | nobody              | x        |    99 |    99 | Nobody                                                          | /                         | /sbin/nologin  |
| 14 | systemd-network     | x        |   192 |   192 | systemd Network Management                                      | /                         | /sbin/nologin  |
| 15 | dbus                | x        |    81 |    81 | System message bus                                              | /                         | /sbin/nologin  |
| 16 | polkitd             | x        |   999 |   998 | User for polkitd                                                | /                         | /sbin/nologin  |
| 17 | libstoragemgmt      | x        |   998 |   996 | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| 18 | rpc                 | x        |    32 |    32 | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| 19 | colord              | x        |   997 |   995 | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| 20 | saslauth            | x        |   996 |    76 | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| 21 | abrt                | x        |   173 |   173 |                                                                 | /etc/abrt                 | /sbin/nologin  |
| 22 | rtkit               | x        |   172 |   172 | RealtimeKit                                                     | /proc                     | /sbin/nologin  |
| 23 | radvd               | x        |    75 |    75 | radvd user                                                      | /                         | /sbin/nologin  |
| 24 | chrony              | x        |   995 |   993 |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| 25 | tss                 | x        |    59 |    59 | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| 26 | usbmuxd             | x        |   113 |   113 | usbmuxd user                                                    | /                         | /sbin/nologin  |
| 27 | geoclue             | x        |   994 |   991 | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| 28 | qemu                | x        |   107 |   107 | qemu user                                                       | /                         | /sbin/nologin  |
| 29 | rpcuser             | x        |    29 |    29 | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| 30 | nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| 31 | setroubleshoot      | x        |   993 |   990 |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| 32 | pulse               | x        |   171 |   171 | PulseAudio System Daemon                                        | /var/run/pulse            | /sbin/nologin  |
| 33 | gdm                 | x        |    42 |    42 |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| 34 | gnome-initial-setup | x        |   992 |   987 |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| 35 | sshd                | x        |    74 |    74 | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| 36 | avahi               | x        |    70 |    70 | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| 37 | postfix             | x        |    89 |    89 |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| 38 | ntp                 | x        |    38 |    38 |                                                                 | /etc/ntp                  | /sbin/nologin  |
| 39 | tcpdump             | x        |    72 |    72 |                                                                 | /                         | /sbin/nologin  |
| 40 | lisi                | x        |  1000 |  1000 | lisi                                                            | /home/lisi                | /bin/bash      |
| 41 | mysql               | x        |    27 |    27 | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| 42 | apache              | x        |    48 |    48 | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
| 43 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bahs      |
| 44 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 45 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 46 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
46 rows in set (0.00 sec)

insert  into  user (name,shell,uid)
values
("lucy","/bin/bash","1999");

mysql> insert  into  user (name,shell,uid)
    -> values
    -> ("lucy","/bin/bash","1999");
Query OK, 1 row affected (0.03 sec)

mysql> select  *  from user;
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| id | name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
|  1 | root                | x        |     0 |     0 | root                                                            | /root                     | /bin/bash      |
|  2 | bin                 | x        |     1 |     1 | bin                                                             | /bin                      | /sbin/nologin  |
|  3 | daemon              | x        |     2 |     2 | daemon                                                          | /sbin                     | /sbin/nologin  |
|  4 | adm                 | x        |     3 |     4 | adm                                                             | /var/adm                  | /sbin/nologin  |
|  5 | lp                  | x        |     4 |     7 | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
|  6 | sync                | x        |     5 |     0 | sync                                                            | /sbin                     | /bin/sync      |
|  7 | shutdown            | x        |     6 |     0 | shutdown                                                        | /sbin                     | /sbin/shutdown |
|  8 | halt                | x        |     7 |     0 | halt                                                            | /sbin                     | /sbin/halt     |
|  9 | mail                | x        |     8 |    12 | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| 10 | operator            | x        |    11 |     0 | operator                                                        | /root                     | /sbin/nologin  |
| 11 | games               | x        |    12 |   100 | games                                                           | /usr/games                | /sbin/nologin  |
| 12 | ftp                 | x        |    14 |    50 | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| 13 | nobody              | x        |    99 |    99 | Nobody                                                          | /                         | /sbin/nologin  |
| 14 | systemd-network     | x        |   192 |   192 | systemd Network Management                                      | /                         | /sbin/nologin  |
| 15 | dbus                | x        |    81 |    81 | System message bus                                              | /                         | /sbin/nologin  |
| 16 | polkitd             | x        |   999 |   998 | User for polkitd                                                | /                         | /sbin/nologin  |
| 17 | libstoragemgmt      | x        |   998 |   996 | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| 18 | rpc                 | x        |    32 |    32 | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| 19 | colord              | x        |   997 |   995 | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| 20 | saslauth            | x        |   996 |    76 | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| 21 | abrt                | x        |   173 |   173 |                                                                 | /etc/abrt                 | /sbin/nologin  |
| 22 | rtkit               | x        |   172 |   172 | RealtimeKit                                                     | /proc                     | /sbin/nologin  |
| 23 | radvd               | x        |    75 |    75 | radvd user                                                      | /                         | /sbin/nologin  |
| 24 | chrony              | x        |   995 |   993 |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| 25 | tss                 | x        |    59 |    59 | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| 26 | usbmuxd             | x        |   113 |   113 | usbmuxd user                                                    | /                         | /sbin/nologin  |
| 27 | geoclue             | x        |   994 |   991 | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| 28 | qemu                | x        |   107 |   107 | qemu user                                                       | /                         | /sbin/nologin  |
| 29 | rpcuser             | x        |    29 |    29 | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| 30 | nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| 31 | setroubleshoot      | x        |   993 |   990 |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| 32 | pulse               | x        |   171 |   171 | PulseAudio System Daemon                                        | /var/run/pulse            | /sbin/nologin  |
| 33 | gdm                 | x        |    42 |    42 |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| 34 | gnome-initial-setup | x        |   992 |   987 |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| 35 | sshd                | x        |    74 |    74 | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| 36 | avahi               | x        |    70 |    70 | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| 37 | postfix             | x        |    89 |    89 |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| 38 | ntp                 | x        |    38 |    38 |                                                                 | /etc/ntp                  | /sbin/nologin  |
| 39 | tcpdump             | x        |    72 |    72 |                                                                 | /                         | /sbin/nologin  |
| 40 | lisi                | x        |  1000 |  1000 | lisi                                                            | /home/lisi                | /bin/bash      |
| 41 | mysql               | x        |    27 |    27 | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| 42 | apache              | x        |    48 |    48 | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
| 43 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bahs      |
| 44 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 45 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 46 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 47 | lucy                | NULL     |  1999 |  NULL | NULL                                                            | NULL                      | /bin/bash      |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
47 rows in set (0.00 sec)

insert  into  user (name,shell,uid)
values
("lucy1","/bin/bash","1999"),
("lucy2","/bin/bash","1999"),
("lucy3","/bin/bash","1999");

mysql> insert  into  user (name,shell,uid)
    -> values
    -> ("lucy1","/bin/bash","1999"),
    -> ("lucy2","/bin/bash","1999"),
    -> ("lucy3","/bin/bash","1999");
Query OK, 3 rows affected (0.04 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> select  *  from user;
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| id | name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
|  1 | root                | x        |     0 |     0 | root                                                            | /root                     | /bin/bash      |
|  2 | bin                 | x        |     1 |     1 | bin                                                             | /bin                      | /sbin/nologin  |
|  3 | daemon              | x        |     2 |     2 | daemon                                                          | /sbin                     | /sbin/nologin  |
|  4 | adm                 | x        |     3 |     4 | adm                                                             | /var/adm                  | /sbin/nologin  |
|  5 | lp                  | x        |     4 |     7 | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
|  6 | sync                | x        |     5 |     0 | sync                                                            | /sbin                     | /bin/sync      |
|  7 | shutdown            | x        |     6 |     0 | shutdown                                                        | /sbin                     | /sbin/shutdown |
|  8 | halt                | x        |     7 |     0 | halt                                                            | /sbin                     | /sbin/halt     |
|  9 | mail                | x        |     8 |    12 | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| 10 | operator            | x        |    11 |     0 | operator                                                        | /root                     | /sbin/nologin  |
| 11 | games               | x        |    12 |   100 | games                                                           | /usr/games                | /sbin/nologin  |
| 12 | ftp                 | x        |    14 |    50 | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| 13 | nobody              | x        |    99 |    99 | Nobody                                                          | /                         | /sbin/nologin  |
| 14 | systemd-network     | x        |   192 |   192 | systemd Network Management                                      | /                         | /sbin/nologin  |
| 15 | dbus                | x        |    81 |    81 | System message bus                                              | /                         | /sbin/nologin  |
| 16 | polkitd             | x        |   999 |   998 | User for polkitd                                                | /                         | /sbin/nologin  |
| 17 | libstoragemgmt      | x        |   998 |   996 | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| 18 | rpc                 | x        |    32 |    32 | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| 19 | colord              | x        |   997 |   995 | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| 20 | saslauth            | x        |   996 |    76 | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| 21 | abrt                | x        |   173 |   173 |                                                                 | /etc/abrt                 | /sbin/nologin  |
| 22 | rtkit               | x        |   172 |   172 | RealtimeKit                                                     | /proc                     | /sbin/nologin  |
| 23 | radvd               | x        |    75 |    75 | radvd user                                                      | /                         | /sbin/nologin  |
| 24 | chrony              | x        |   995 |   993 |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| 25 | tss                 | x        |    59 |    59 | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| 26 | usbmuxd             | x        |   113 |   113 | usbmuxd user                                                    | /                         | /sbin/nologin  |
| 27 | geoclue             | x        |   994 |   991 | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| 28 | qemu                | x        |   107 |   107 | qemu user                                                       | /                         | /sbin/nologin  |
| 29 | rpcuser             | x        |    29 |    29 | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| 30 | nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| 31 | setroubleshoot      | x        |   993 |   990 |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| 32 | pulse               | x        |   171 |   171 | PulseAudio System Daemon                                        | /var/run/pulse            | /sbin/nologin  |
| 33 | gdm                 | x        |    42 |    42 |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| 34 | gnome-initial-setup | x        |   992 |   987 |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| 35 | sshd                | x        |    74 |    74 | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| 36 | avahi               | x        |    70 |    70 | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| 37 | postfix             | x        |    89 |    89 |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| 38 | ntp                 | x        |    38 |    38 |                                                                 | /etc/ntp                  | /sbin/nologin  |
| 39 | tcpdump             | x        |    72 |    72 |                                                                 | /                         | /sbin/nologin  |
| 40 | lisi                | x        |  1000 |  1000 | lisi                                                            | /home/lisi                | /bin/bash      |
| 41 | mysql               | x        |    27 |    27 | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| 42 | apache              | x        |    48 |    48 | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
| 43 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bahs      |
| 44 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 45 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 46 | ok                  | x        |  2000 |  2000 | student user                                                    | /home/ok                  | /bin/bash      |
| 47 | lucy                | NULL     |  1999 |  NULL | NULL                                                            | NULL                      | /bin/bash      |
| 48 | lucy1               | NULL     |  1999 |  NULL | NULL                                                            | NULL                      | /bin/bash      |
| 49 | lucy2               | NULL     |  1999 |  NULL | NULL                                                            | NULL                      | /bin/bash      |
| 50 | lucy3               | NULL     |  1999 |  NULL | NULL                                                            | NULL                      | /bin/bash      |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
50 rows in set (0.00 sec)


mysql> select name,uid,shell from user;
+---------------------+-------+----------------+
| name                | uid   | shell          |
+---------------------+-------+----------------+
| root                |     0 | /bin/bash      |
| bin                 |     1 | /sbin/nologin  |
| daemon              |     2 | /sbin/nologin  |
| adm                 |     3 | /sbin/nologin  |
| lp                  |     4 | /sbin/nologin  |
| sync                |     5 | /bin/sync      |
| shutdown            |     6 | /sbin/shutdown |
| halt                |     7 | /sbin/halt     |
| mail                |     8 | /sbin/nologin  |
| operator            |    11 | /sbin/nologin  |
| games               |    12 | /sbin/nologin  |
| ftp                 |    14 | /sbin/nologin  |
| nobody              |    99 | /sbin/nologin  |
| systemd-network     |   192 | /sbin/nologin  |
| dbus                |    81 | /sbin/nologin  |
| polkitd             |   999 | /sbin/nologin  |
| libstoragemgmt      |   998 | /sbin/nologin  |
| rpc                 |    32 | /sbin/nologin  |
| colord              |   997 | /sbin/nologin  |
| saslauth            |   996 | /sbin/nologin  |
| abrt                |   173 | /sbin/nologin  |
| rtkit               |   172 | /sbin/nologin  |
| radvd               |    75 | /sbin/nologin  |
| chrony              |   995 | /sbin/nologin  |
| tss                 |    59 | /sbin/nologin  |
| usbmuxd             |   113 | /sbin/nologin  |
| geoclue             |   994 | /sbin/nologin  |
| qemu                |   107 | /sbin/nologin  |
| rpcuser             |    29 | /sbin/nologin  |
| nfsnobody           | 65534 | /sbin/nologin  |
| setroubleshoot      |   993 | /sbin/nologin  |
| pulse               |   171 | /sbin/nologin  |
| gdm                 |    42 | /sbin/nologin  |
| gnome-initial-setup |   992 | /sbin/nologin  |
| sshd                |    74 | /sbin/nologin  |
| avahi               |    70 | /sbin/nologin  |
| postfix             |    89 | /sbin/nologin  |
| ntp                 |    38 | /sbin/nologin  |
| tcpdump             |    72 | /sbin/nologin  |
| lisi                |  1000 | /bin/bash      |
| mysql               |    27 | /bin/false     |
| apache              |    48 | /sbin/nologin  |
| ok                  |  2000 | /bin/bahs      |
| ok                  |  2000 | /bin/bash      |
| ok                  |  2000 | /bin/bash      |
| ok                  |  2000 | /bin/bash      |
| lucy                |  1999 | /bin/bash      |
| lucy1               |  1999 | /bin/bash      |
| lucy2               |  1999 | /bin/bash      |
| lucy3               |  1999 | /bin/bash      |
+---------------------+-------+----------------+
50 rows in set (0.00 sec)

mysql> select name,uid,shell from user where id=1;
+------+------+-----------+
| name | uid  | shell     |
+------+------+-----------+
| root |    0 | /bin/bash |
+------+------+-----------+
1 row in set (0.00 sec)

mysql> select name,uid,shell from user where id<6;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /bin/bash     |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin |
+--------+------+---------------+
5 rows in set (0.00 sec)

mysql> select name,uid,shell from user where id>=6;
+---------------------+-------+----------------+
| name                | uid   | shell          |
+---------------------+-------+----------------+
| sync                |     5 | /bin/sync      |
| shutdown            |     6 | /sbin/shutdown |
| halt                |     7 | /sbin/halt     |
| mail                |     8 | /sbin/nologin  |
| operator            |    11 | /sbin/nologin  |
| games               |    12 | /sbin/nologin  |
| ftp                 |    14 | /sbin/nologin  |
| nobody              |    99 | /sbin/nologin  |
| systemd-network     |   192 | /sbin/nologin  |
| dbus                |    81 | /sbin/nologin  |
| polkitd             |   999 | /sbin/nologin  |
| libstoragemgmt      |   998 | /sbin/nologin  |
| rpc                 |    32 | /sbin/nologin  |
| colord              |   997 | /sbin/nologin  |
| saslauth            |   996 | /sbin/nologin  |
| abrt                |   173 | /sbin/nologin  |
| rtkit               |   172 | /sbin/nologin  |
| radvd               |    75 | /sbin/nologin  |
| chrony              |   995 | /sbin/nologin  |
| tss                 |    59 | /sbin/nologin  |
| usbmuxd             |   113 | /sbin/nologin  |
| geoclue             |   994 | /sbin/nologin  |
| qemu                |   107 | /sbin/nologin  |
| rpcuser             |    29 | /sbin/nologin  |
| nfsnobody           | 65534 | /sbin/nologin  |
| setroubleshoot      |   993 | /sbin/nologin  |
| pulse               |   171 | /sbin/nologin  |
| gdm                 |    42 | /sbin/nologin  |
| gnome-initial-setup |   992 | /sbin/nologin  |
| sshd                |    74 | /sbin/nologin  |
| avahi               |    70 | /sbin/nologin  |
| postfix             |    89 | /sbin/nologin  |
| ntp                 |    38 | /sbin/nologin  |
| tcpdump             |    72 | /sbin/nologin  |
| lisi                |  1000 | /bin/bash      |
| mysql               |    27 | /bin/false     |
| apache              |    48 | /sbin/nologin  |
| ok                  |  2000 | /bin/bahs      |
| ok                  |  2000 | /bin/bash      |
| ok                  |  2000 | /bin/bash      |
| ok                  |  2000 | /bin/bash      |
| lucy                |  1999 | /bin/bash      |
| lucy1               |  1999 | /bin/bash      |
| lucy2               |  1999 | /bin/bash      |
| lucy3               |  1999 | /bin/bash      |
+---------------------+-------+----------------+
45 rows in set (0.00 sec)

mysql> select name,uid,shell from user where id<=6;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /bin/bash     |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin |
| sync   |    5 | /bin/sync     |
+--------+------+---------------+
6 rows in set (0.00 sec)

mysql> select name,uid,shell from user where shell="/bin/bash";
+-------+------+-----------+
| name  | uid  | shell     |
+-------+------+-----------+
| root  |    0 | /bin/bash |
| lisi  | 1000 | /bin/bash |
| ok    | 2000 | /bin/bash |
| ok    | 2000 | /bin/bash |
| ok    | 2000 | /bin/bash |
| lucy  | 1999 | /bin/bash |
| lucy1 | 1999 | /bin/bash |
| lucy2 | 1999 | /bin/bash |
| lucy3 | 1999 | /bin/bash |
+-------+------+-----------+
9 rows in set (0.00 sec)


更新记录字段的值　update 

update 表　set 字段名＝值，字段名＝值，　．．．where 条件；

删除记录 delete (删除表里的行)
delete from  表　where 条件；

匹配条件的表示方式（）
数值比较　　＞　　＞＝　　＜　　＜＝　　＝　　！＝
where  字段名　符号　数值

字符比较



mysql>  insert into user(id ,name) values(51,""),(52,"null"),(53,null);
Query OK, 3 rows affected (0.08 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> select id,name from user where id>50;
+----+------+
| id | name |
+----+------+
| 51 　|      　　|
| 52 | null |
| 53 | NULL |
+----+------+
3 rows in set (0.00 sec)


mysql> select id,name from user where name is null;
+----+------+
| id | name |
+----+------+
| 53 | NULL |
+----+------+
1 row in set (0.00 sec)


mysql> update user set password=null where name="bin";
Query OK, 1 row affected (0.28 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from user where name="bin";
+----+------+----------+------+------+---------+---------+---------------+
| id | name | password | uid  | gid  | comment | homedir | shell         |
+----+------+----------+------+------+---------+---------+---------------+
|  2 | bin  | NULL     |    1 | 1000 | bin     | /bin    | /sbin/nologin |
+----+------+----------+------+------+---------+---------+---------------+
1 row in set (0.00 sec)

（）用来提高优先级

mysql> select name ,uid  from user  where name="root" or name="bin" and uid=1;
+------+------+
| name | uid  |
+------+------+
| bin  |    1 |
| root |    0 |
+------+------+
2 rows in set (0.00 sec)

mysql> select name ,uid  from user  where (name="root" or name="bin") and uid=1;
+------+------+
| name | uid  |
+------+------+
| bin  |    1 |
+------+------+
1 row in set (0.00 sec)


mysql> select  name,uid from  user  where uid in(1,7,8,55,1000);
+------+------+
| name | uid  |
+------+------+
| bin  |    1 |
| halt |    7 |
| mail |    8 |
| lisi | 1000 |
+------+------+
4 rows in set (0.00 sec)

mysql> select  name,shell  from user where shell not in ("/bin/bash","/sbin/nologin");
+----------+----------------+
| name     | shell          |
+----------+----------------+
| sync     | /bin/sync      |
| shutdown | /sbin/shutdown |
| halt     | /sbin/halt     |
| mysql    | /bin/false     |
+----------+----------------+
4 rows in set (0.00 sec)


mysql> select name from user where name in ("root","sync","lucy");
+------+
| name |
+------+
| lucy |
| root |
| sync |
+------+
3 rows in set (0.00 sec)


mysql> select name,id from user where id between 1 and 10 ;
+----------+----+
| name     | id |
+----------+----+
| root     |  1 |
| bin      |  2 |
| daemon   |  3 |
| adm      |  4 |
| lp       |  5 |
| sync     |  6 |
| shutdown |  7 |
| halt     |  8 |
| mail     |  9 |
| operator | 10 |
+----------+----+
10 rows in set (0.00 sec)

mysql> select   *  from user where  uid between  10 and 20;
+----+----------+----------+------+------+----------+------------+---------------+
| id | name     | password | uid  | gid  | comment  | homedir    | shell         |
+----+----------+----------+------+------+----------+------------+---------------+
| 10 | operator | A        |   11 | 1000 | operator | /root      | /sbin/nologin |
| 11 | games    | A        |   12 | 1000 | games    | /usr/games | /sbin/nologin |
| 12 | ftp      | A        |   14 | 1000 | FTP User | /var/ftp   | /sbin/nologin |
+----+----------+----------+------+------+----------+------------+---------------+
3 rows in set (0.00 sec)


mysql> select * from user  where uid>=10  and uid <=20;
+----+----------+----------+------+------+----------+------------+---------------+
| id | name     | password | uid  | gid  | comment  | homedir    | shell         |
+----+----------+----------+------+------+----------+------------+---------------+
| 10 | operator | A        |   11 | 1000 | operator | /root      | /sbin/nologin |
| 11 | games    | A        |   12 | 1000 | games    | /usr/games | /sbin/nologin |
| 12 | ftp      | A        |   14 | 1000 | FTP User | /var/ftp   | /sbin/nologin |
+----+----------+----------+------+------+----------+------------+---------------+
3 rows in set (0.00 sec)


distinct 字段名　　　／／　去重显示

mysql> select  distinct shell from  user;
+----------------+
| shell          |
+----------------+
| /bin/bash      |
| /sbin/nologin  |
| /bin/sync      |
| /sbin/shutdown |
| /sbin/halt     |
| /bin/false     |
| NULL           |
+----------------+
7 rows in set (0.01 sec)


mysql> select shell from user where uid <= 500;
+----------------+
| shell          |
+----------------+
| /bin/bash      |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /bin/sync      |
| /sbin/shutdown |
| /sbin/halt     |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /sbin/nologin  |
| /bin/false     |
| /sbin/nologin  |
+----------------+
32 rows in set (0.00 sec)


mysql> select  distinct shell from user where uid <= 500;
+----------------+
| shell          |
+----------------+
| /bin/bash      |
| /sbin/nologin  |
| /bin/sync      |
| /sbin/shutdown |
| /sbin/halt     |
| /bin/false     |
+----------------+
6 rows in set (0.00 sec)

#############################################################


查看mysql历史记录:

查看设置mysql genneral log


smysql> show VARIABLES like '%general_log%';

mysql> set GLOBAL general_log = off;// on-打开; off-关闭

general_log ON
general_log_file    /var/log/mysql/query.log


############################################################################

2018年 07月 14日 星期六 14:32:29 CST

mysql> create table  b4 select *  from teadb.usertab;
Query OK, 42 rows affected (0.55 sec)
Records: 42  Duplicates: 0  Warnings: 0

mysql> select  *  from b4;
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
| id | name                | password | uid   | gid   | comment                                                         | homedir                   | shell          |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
|  1 | root                | x        | 0     | 0     | root                                                            | /root                     | /bin/bash      |
|  2 | bin                 | x        | 1     | 1     | bin                                                             | /bin                      | /sbin/nologin  |
|  3 | daemon              | x        | 2     | 2     | daemon                                                          | /sbin                     | /sbin/nologin  |
|  4 | adm                 | x        | 3     | 4     | adm                                                             | /var/adm                  | /sbin/nologin  |
|  5 | lp                  | x        | 4     | 7     | lp                                                              | /var/spool/lpd            | /sbin/nologin  |
|  6 | sync                | x        | 5     | 0     | sync                                                            | /sbin                     | /bin/sync      |
|  7 | shutdown            | x        | 6     | 0     | shutdown                                                        | /sbin                     | /sbin/shutdown |
|  8 | halt                | x        | 7     | 0     | halt                                                            | /sbin                     | /sbin/halt     |
|  9 | mail                | x        | 8     | 12    | mail                                                            | /var/spool/mail           | /sbin/nologin  |
| 10 | operator            | x        | 11    | 0     | operator                                                        | /root                     | /sbin/nologin  |
| 11 | games               | x        | 12    | 100   | games                                                           | /root                     | /sbin/nologin  |
| 12 | ftp                 | x        | 14    | 50    | FTP User                                                        | /var/ftp                  | /sbin/nologin  |
| 13 | nobody              | x        | 99    | 99    | Nobody                                                          | /                         | /sbin/nologin  |
| 14 | systemd-network     | x        | 192   | 192   | systemd Network Management                                      | /root                     | /sbin/nologin  |
| 15 | dbus                | x        | 81    | 81    | System message bus                                              | /                         | /sbin/nologin  |
| 16 | polkitd             | x        | 999   | 998   | User for polkitd                                                | /                         | /sbin/nologin  |
| 17 | libstoragemgmt      | x        | 998   | 996   | daemon account for libstoragemgmt                               | /var/run/lsm              | /sbin/nologin  |
| 18 | rpc                 | x        | 32    | 32    | Rpcbind Daemon                                                  | /var/lib/rpcbind          | /sbin/nologin  |
| 19 | colord              | x        | 997   | 995   | User for colord                                                 | /var/lib/colord           | /sbin/nologin  |
| 20 | saslauth            | x        | 996   | 76    | Saslauthd user                                                  | /run/saslauthd            | /sbin/nologin  |
| 21 | abrt                | x        | 173   | 173   |                                                                 | /root                     | /sbin/nologin  |
| 22 | rtkit               | x        | 172   | 172   | RealtimeKit                                                     | /root                     | /sbin/nologin  |
| 23 | radvd               | x        | 75    | 75    | radvd user                                                      | /                         | /sbin/nologin  |
| 24 | chrony              | x        | 995   | 993   |                                                                 | /var/lib/chrony           | /sbin/nologin  |
| 25 | tss                 | x        | 59    | 59    | Account used by the trousers package to sandbox the tcsd daemon | /dev/null                 | /sbin/nologin  |
| 26 | usbmuxd             | x        | 113   | 113   | usbmuxd user                                                    | /root                     | /sbin/nologin  |
| 27 | geoclue             | x        | 994   | 991   | User for geoclue                                                | /var/lib/geoclue          | /sbin/nologin  |
| 28 | qemu                | x        | 107   | 107   | qemu user                                                       | /root                     | /sbin/nologin  |
| 29 | rpcuser             | x        | 29    | 29    | RPC Service User                                                | /var/lib/nfs              | /sbin/nologin  |
| 30 | nfsnobody           | x        | 65534 | 65534 | Anonymous NFS User                                              | /var/lib/nfs              | /sbin/nologin  |
| 31 | setroubleshoot      | x        | 993   | 990   |                                                                 | /var/lib/setroubleshoot   | /sbin/nologin  |
| 32 | pulse               | x        | 171   | 171   | PulseAudio System Daemon                                        | /root                     | /sbin/nologin  |
| 33 | gdm                 | x        | 42    | 42    |                                                                 | /var/lib/gdm              | /sbin/nologin  |
| 34 | gnome-initial-setup | x        | 992   | 987   |                                                                 | /run/gnome-initial-setup/ | /sbin/nologin  |
| 35 | sshd                | x        | 74    | 74    | Privilege-separated SSH                                         | /var/empty/sshd           | /sbin/nologin  |
| 36 | avahi               | x        | 70    | 70    | Avahi mDNS/DNS-SD Stack                                         | /var/run/avahi-daemon     | /sbin/nologin  |
| 37 | postfix             | x        | 89    | 89    |                                                                 | /var/spool/postfix        | /sbin/nologin  |
| 38 | ntp                 | x        | 38    | 38    |                                                                 | /etc/ntp                  | /sbin/nologin  |
| 39 | tcpdump             | x        | 72    | 72    |                                                                 | /                         | /sbin/nologin  |
| 40 | lisi                | x        | 1000  | 1000  | lisi                                                            | /home/lisi                | /bin/bash      |
| 41 | mysql               | x        | 27    | 27    | MySQL Server                                                    | /var/lib/mysql            | /bin/false     |
| 42 | apache              | x        | 48    | 48    | Apache                                                          | /usr/share/httpd          | /sbin/nologin  |
+----+---------------------+----------+-------+-------+-----------------------------------------------------------------+---------------------------+----------------+
42 rows in set (0.00 sec)

mysql> 
mysql> create table b5 select id,name,uid from b4  order by uid;
Query OK, 42 rows affected (0.29 sec)
Records: 42  Duplicates: 0  Warnings: 0

mysql> select  *  from b5;
+----+---------------------+-------+
| id | name                | uid   |
+----+---------------------+-------+
|  1 | root                | 0     |
|  2 | bin                 | 1     |
| 40 | lisi                | 1000  |
| 28 | qemu                | 107   |
| 10 | operator            | 11    |
| 26 | usbmuxd             | 113   |
| 11 | games               | 12    |
| 12 | ftp                 | 14    |
| 32 | pulse               | 171   |
| 22 | rtkit               | 172   |
| 21 | abrt                | 173   |
| 14 | systemd-network     | 192   |
|  3 | daemon              | 2     |
| 41 | mysql               | 27    |
| 29 | rpcuser             | 29    |
|  4 | adm                 | 3     |
| 18 | rpc                 | 32    |
| 38 | ntp                 | 38    |
|  5 | lp                  | 4     |
| 33 | gdm                 | 42    |
| 42 | apache              | 48    |
|  6 | sync                | 5     |
| 25 | tss                 | 59    |
|  7 | shutdown            | 6     |
| 30 | nfsnobody           | 65534 |
|  8 | halt                | 7     |
| 36 | avahi               | 70    |
| 39 | tcpdump             | 72    |
| 35 | sshd                | 74    |
| 23 | radvd               | 75    |
|  9 | mail                | 8     |
| 15 | dbus                | 81    |
| 37 | postfix             | 89    |
| 13 | nobody              | 99    |
| 34 | gnome-initial-setup | 992   |
| 31 | setroubleshoot      | 993   |
| 27 | geoclue             | 994   |
| 24 | chrony              | 995   |
| 20 | saslauth            | 996   |
| 19 | colord              | 997   |
| 17 | libstoragemgmt      | 998   |
| 16 | polkitd             | 999   |
+----+---------------------+-------+
42 rows in set (0.00 sec)

mysql> create  table user1  select *  from  teadb.usertab where 2=5;    //  where 2=5 这个条件不存在,所以创建这个字段表
Query OK, 0 rows affected (0.27 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> select  *  from user1;
Empty set (0.00 sec)

mysql> desc user1;
+----------+-------------+------+-----+---------+-------+
| Field    | Type        | Null | Key | Default | Extra |
+----------+-------------+------+-----+---------+-------+
| id       | int(11)     | NO   |     | NULL    |       |
| name     | char(66)    | YES  |     | NULL    |       |
| password | char(22)    | YES  |     | NULL    |       |
| uid      | varchar(55) | YES  |     | NULL    |       |
| gid      | varchar(66) | YES  |     | NULL    |       |
| comment  | varchar(99) | YES  |     | NULL    |       |
| homedir  | varchar(88) | YES  |     | NULL    |       |
| shell    | varchar(66) | YES  |     | NULL    |       |
+----------+-------------+------+-----+---------+-------+
8 rows in set (0.00 sec)


mysql> select *  from t1;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   | 0    | /bin/bash     |
| bin    | 1    | /sbin/nologin |
| daemon | 2    | /sbin/nologin |
+--------+------+---------------+
3 rows in set (0.00 sec)

mysql> create table t2 select name,password,uid ,homedir from b4 limit 5;
Query OK, 5 rows affected (0.28 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> select  *  from t2;
+--------+----------+------+----------------+
| name   | password | uid  | homedir        |
+--------+----------+------+----------------+
| root   | x        | 0    | /root          |
| bin    | x        | 1    | /bin           |
| daemon | x        | 2    | /sbin          |
| adm    | x        | 3    | /var/adm       |
| lp     | x        | 4    | /var/spool/lpd |
+--------+----------+------+----------------+
5 rows in set (0.00 sec)


mysql> select *  from t1,t2;  //笛卡尔积
+--------+------+---------------+--------+----------+------+----------------+
| name   | uid  | shell         | name   | password | uid  | homedir        |
+--------+------+---------------+--------+----------+------+----------------+
| root   | 0    | /bin/bash     | root   | x        | 0    | /root          |
| bin    | 1    | /sbin/nologin | root   | x        | 0    | /root          |
| daemon | 2    | /sbin/nologin | root   | x        | 0    | /root          |
| root   | 0    | /bin/bash     | bin    | x        | 1    | /bin           |
| bin    | 1    | /sbin/nologin | bin    | x        | 1    | /bin           |
| daemon | 2    | /sbin/nologin | bin    | x        | 1    | /bin           |
| root   | 0    | /bin/bash     | daemon | x        | 2    | /sbin          |
| bin    | 1    | /sbin/nologin | daemon | x        | 2    | /sbin          |
| daemon | 2    | /sbin/nologin | daemon | x        | 2    | /sbin          |
| root   | 0    | /bin/bash     | adm    | x        | 3    | /var/adm       |
| bin    | 1    | /sbin/nologin | adm    | x        | 3    | /var/adm       |
| daemon | 2    | /sbin/nologin | adm    | x        | 3    | /var/adm       |
| root   | 0    | /bin/bash     | lp     | x        | 4    | /var/spool/lpd |
| bin    | 1    | /sbin/nologin | lp     | x        | 4    | /var/spool/lpd |
| daemon | 2    | /sbin/nologin | lp     | x        | 4    | /var/spool/lpd |
+--------+------+---------------+--------+----------+------+----------------+
15 rows in set (0.00 sec)



嵌套查询:

相同表
 /var/lib/mysql/host50.log
mysql>  select name ,uid from  b4 where uid <= (select avg(uid) from b4); //b4可以为不同数据库的不同表
+---------------------+------+
| name                | uid  |
+---------------------+------+
| root                | 0    |
| bin                 | 1    |
| daemon              | 2    |
| adm                 | 3    |
| lp                  | 4    |
| sync                | 5    |
| shutdown            | 6    |
| halt                | 7    |
| mail                | 8    |
| operator            | 11   |
| games               | 12   |
| ftp                 | 14   |
| nobody              | 99   |
| systemd-network     | 192  |
| dbus                | 81   |
| polkitd             | 999  |
| libstoragemgmt      | 998  |
| rpc                 | 32   |
| colord              | 997  |
| saslauth            | 996  |
| abrt                | 173  |
| rtkit               | 172  |
| radvd               | 75   |
| chrony              | 995  |
| tss                 | 59   |
| usbmuxd             | 113  |
| geoclue             | 994  |
| qemu                | 107  |
| rpcuser             | 29   |
| setroubleshoot      | 993  |
| pulse               | 171  |
| gdm                 | 42   |
| gnome-initial-setup | 992  |
| sshd                | 74   |
| avahi               | 70   |
| postfix             | 89   |
| ntp                 | 38   |
| tcpdump             | 72   |
| lisi                | 1000 |
| mysql               | 27   |
| apache              | 48   |
+---------------------+------+
41 rows in set (0.00 sec)


不同表

mysql> select *  from t1;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   | 0    | /bin/bash     |
| bin    | 1    | /sbin/nologin |
| daemon | 2    | /sbin/nologin |
+--------+------+---------------+
3 rows in set (0.00 sec)

mysql> create table t2 select name,password,uid ,homedir from b4 limit 5;
Query OK, 5 rows affected (0.28 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> select  *  from t2;
+--------+----------+------+----------------+
| name   | password | uid  | homedir        |
+--------+----------+------+----------------+
| root   | x        | 0    | /root          |
| bin    | x        | 1    | /bin           |
| daemon | x        | 2    | /sbin          |
| adm    | x        | 3    | /var/adm       |
| lp     | x        | 4    | /var/spool/lpd |
+--------+----------+------+----------------+
5 rows in set (0.00 sec)



mysql> select name from t2 where name in (select name from t1);
+--------+
| name   |
+--------+
| root   |
| bin    |
| daemon |
+--------+
3 rows in set (0.00 sec)


########################################################

连接查询

左连接:以左边的为主显示查询结果    
select  字段名列表  from  表名A  left join  表名B on 条件;


右连接:以右边的为主显示查询结果    right join




mysql> select *  from b61;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   | 0    | /bin/bash     |
| bin    | 1    | /sbin/nologin |
| daemon | 2    | /sbin/nologin |
| adm    | 3    | /sbin/nologin |
| lp     | 4    | /sbin/nologin |
+--------+------+---------------+
5 rows in set (0.00 sec)


mysql> create  table  b62  select  name ,uid, shell from b4 limit 7;
Query OK, 7 rows affected (0.34 sec)
Records: 7  Duplicates: 0  Warnings: 0

mysql> select *  from b62;
+----------+------+----------------+
| name     | uid  | shell          |
+----------+------+----------------+
| root     | 0    | /bin/bash      |
| bin      | 1    | /sbin/nologin  |
| daemon   | 2    | /sbin/nologin  |
| adm      | 3    | /sbin/nologin  |
| lp       | 4    | /sbin/nologin  |
| sync     | 5    | /bin/sync      |
| shutdown | 6    | /sbin/shutdown |
+----------+------+----------------+
7 rows in set (0.00 sec)

mysql> select * from  b61 left join b62 on b61.uid = b62.uid;
+--------+------+---------------+--------+------+---------------+
| name   | uid  | shell         | name   | uid  | shell         |
+--------+------+---------------+--------+------+---------------+
| root   | 0    | /bin/bash     | root   | 0    | /bin/bash     |
| bin    | 1    | /sbin/nologin | bin    | 1    | /sbin/nologin |
| daemon | 2    | /sbin/nologin | daemon | 2    | /sbin/nologin |
| adm    | 3    | /sbin/nologin | adm    | 3    | /sbin/nologin |
| lp     | 4    | /sbin/nologin | lp     | 4    | /sbin/nologin |
+--------+------+---------------+--------+------+---------------+
5 rows in set (0.00 sec)

mysql> select * from  b61 right join b62 on b61.uid = b62.uid;
+--------+------+---------------+----------+------+----------------+
| name   | uid  | shell         | name     | uid  | shell          |
+--------+------+---------------+----------+------+----------------+
| root   | 0    | /bin/bash     | root     | 0    | /bin/bash      |
| bin    | 1    | /sbin/nologin | bin      | 1    | /sbin/nologin  |
| daemon | 2    | /sbin/nologin | daemon   | 2    | /sbin/nologin  |
| adm    | 3    | /sbin/nologin | adm      | 3    | /sbin/nologin  |
| lp     | 4    | /sbin/nologin | lp       | 4    | /sbin/nologin  |
| NULL   | NULL | NULL          | sync     | 5    | /bin/sync      |
| NULL   | NULL | NULL          | shutdown | 6    | /sbin/shutdown |
+--------+------+---------------+----------+------+----------------+
7 rows in set (0.00 sec)

###################################################################


查询主机名
mysql> select  @@hostname;
+------------+
| @@hostname |
+------------+
| host50     |
+------------+
1 row in set (0.00 sec)

查看当前的数据服务，支持哪种搜索引擎
mysql> show engines;
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| Engine             | Support | Comment                                                        | Transactions | XA   | Savepoints |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| InnoDB             | DEFAULT | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES        |
| MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |
| MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |
| BLACKHOLE          | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |
| MyISAM             | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |
| CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO         |
| ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO         |
| PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO         |
| FEDERATED          | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
9 rows in set (0.00 sec)




InnoDB
事物Transactions

修改数据库服务的默认使用搜索引擎？
#sytemctl stop  mysqld
#vim   /etvc/my.cnf
[mysqld]
default-storage-engine=myisam
:x
#systemctl start mysqld

mysql>show engines;

建表
create table 表名 (name int) engine=存储引擎名


修改表使用的存储引擎
alter table 表名  engine=存储引擎名


myisam 存储引擎的特点
支持表级锁（客户端连接数据库服务器后，对表的数据做访问时，若表的存储是myisam的话，会给整张表加锁）
不支持事务和事务回滚
每个表对应三个表文件
表.frm   表结构  desc 表  
表.MYD   表数据
表.MYI   表的index索引信息


InnoDB的特点
支持行级锁（客户端连接数据库服务器后，对表的数据做访问时，若表的存储是InnoDB的话，只会给表中被访问的行加锁）
支持事务回滚，外键   
每个表对应2个表文件
表.frm  表结构 
表.ibd  表数据和index索引


锁粒度 （锁表的范围）
表锁
锁类型：
读锁 （共享锁）         当对一张表查询时（select）操作时 会加读锁
写锁  (排他锁或互斥锁)  当对一张表执行写（insert update delete）操作时 会加写锁


事务(transaction)：一次sql操作从建立连接到操作完成断开连接的访问过程称作事务

支持事务的表可以做事务回滚:一次sql操作有任意一步美亚执行成功会恢复所有操作。（对innoDB存储引擎的表访问时必须任意一步操作都成功，才能完成操作）

使用事务的的操作  银行的汇款或转账业务

默认
mysql> show  variables like "autocommit";
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| autocommit    | ON    |
+---------------+-------+
1 row in set (0.00 sec)


mysql> set autocommit=off;


mysql> show  variables like "autocommit";
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| autocommit    | OFF   |
+---------------+-------+
1 row in set (0.00 sec)


mysql> show  variables like "autocommit";
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| autocommit    | OFF   |
+---------------+-------+
1 row in set (0.00 sec)


###########################################################

完全备份：mysqldump
完全恢复：mysql


]#man  mysqldump
]#mysqldump    -uroot   -p123456 库名 > 目录名/文件名.sql

库名的表示方式：
--all-databases  或 -A 所有库所有表
]#mysqldump   -uroot -p123456  -A > /bakdir/alldb.sql
mysqldump: [Warning] Using a password on the command line interface can be insecure.


库名  备份库下的所有表
]#mysqldump   -uroot -p123456  db5 > /bakdir/db5.sql
mysqldump: [Warning] Using a password on the command line interface can be insecure.

库名  表名   备份一张表的所有记录
]#mysqldump   -uroot -p123456  db5  t1 > /bakdir/db5_user.sql
mysqldump: [Warning] Using a password on the command line interface can be insecure.


-B  库名1  库名2  备份某几个库的所有数据
]#mysqldump   -uroot -p123456  -B  db5  db55 > /bakdir/twodb.sql
mysqldump: [Warning] Using a password on the command line interface can be insecure.


mysqldump备份和恢复会锁表

vim  /bakdir/db5.sql
...
LOCK TABLES `t1` WRITE;
/*!40000 ALTER TABLE `t1` DISABLE KEYS */;
/*!40000 ALTER TABLE `t1` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;
...


完全恢复：mysql

方法一：]# mysql -uroot -p123456  库名  < 目录名/文件名.sql

方法二：mysql> source 目录名/文件名.sql



每周一 23点备份数据库服务器上db5库下的所有表到系统的/bakdir

vim  /root/alldb5.sh
#！/bin/bash
x=`date +%F`
 [ -e /bakdir ]  ||  mkdir /bakdir 
mysqldump  -uroot -p123456 db5  > /bakdir/db5_${x}.sql
:x

]#chmod  +x  /root/alldb5.sh


]#/root/alldb5.sh


]#crontab   -e 
00  23  *  *   1    /root/alldb5.sh  &> /dev/null
:x


增量备份与恢复
1.启用mysql服务自带的binlog日志文件
2.安装第3方软件提供的命令innobackupex ***


binlog日志的使用：
日志介绍：是服务日志文件中的一种（默认没有开启）记录除查询之外的sql命令

启用日志：
vim  /etc/my.cnf
[mysqld]
server_id=50   //指定id值
log-bin
binlog-format="mixed"

]# systemctl restart  mysqld
]# cd /var/lib/mysql
]# ls
host50-bin.000001   日志文件> 500M 时自动生成第二个日志文件
host50-bin.index 

查看日志内容：
]# mysqlbinlog  host50-bin.000001



自定义binlog日志名称及存储目录
]#mkdir /logdir
]#chown  mysql  /logdir

vim /etc/my.cnf
[mysql]
log-bin=/logdir/db50
:x

]#systemctl  restart  mysqld
]#mysqlbinlog   /logdir/db50.000001



日志记录格式：


偏移量


]# mysqlbinlog   选项   /logdir/db50.000001
--start-position=数字
--stop-position=数字


时间点
--start-datetime=“yyyy-mm-dd hh:mm:ss”
--stop-datetime=“yyyy-mm-dd hh:mm:ss”

执行日志文件记录的sql命令恢复数据

]# mysqlbinlog  选项 日志文件名 | mysql  -uroot -p123456

]#mysqlbinlog  --start-position=10186  --stop-position=10364  /logdir/db50.000001 | mysql  -uroot -p123456

###################################################################


手动生成新的日志文件

]#mysqldump  -uroot -p123456 --flush-logs  db3 > /bakdir/db3.sql


或者

mysql>flush  logs;

或者
systemctl restart mysqld

或者

]#mysql -uroot -p123456 -e "flush logs"


mysql> show  master status;   //--查看正在使用的日志文件
+-------------+----------+--------------+------------------+-------------------+
| File        | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |
+-------------+----------+--------------+------------------+-------------------+
| db50.000001 |    13564 |              |                  |                   |
+-------------+----------+--------------+------------------+-------------------+
1 row in set (0.00 sec)



  
删除已有的日志文件

方法一：
mysql> purge  master logs to "db50.000005";
mysql> reset master;

]#rm  -rf /logdir/ *

方法二：安装第3方软件percona提供的命令innobackupex


yum -y install perl-DBD-MySQL.x86_64  perl-Digest-MD5.x86_64

rpm  -ivh  libev-4.15-1.el6.rf.x86_64.rpm

rpm -ivh  percona-xtrabackup-24-2.4.7-1.el7.x86_64.rpm


完全备份和恢复

]#innobackupex  --user root --password 123456  --databases="mysql  performance_schema sys  db"  /allbak  --no-timestamp 

mysql  performance_schema  sys  // --这三个库是系统自带的库

完全恢复
（要求数据库目录必须是空的）




准备恢复数据（回滚备份目录下日志信息）
]# innobackupex  --user root --password 123456  --databases="mysql  performance_schema sys  db"  --apply-log   /allbak  

]#systemctl  stop mysqld

]#rm -rf /var/lib/mysql/ *

把备份目录下数据库拷贝会数据库目录下
]# innobackupex  --user root --password 123456  --databases="mysql  performance_schema sys  db"   --copy-back   /allbak  


修改数据库目录下所有者和组用户为mysql
]#chown -R   mysql:mysql   /var/lib/mysql

重启数据库服务
]#systemctl  restart mysqld


登录查看数据

####################################################################

--修改数据库名：
mysql> show  databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| db                 |
| db1                |
| gamedb             |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
7 rows in set (0.01 sec)

进入/var/lib/mysql
[root@host50 ~]# cd /var/lib/mysql
[root@host50 mysql]# ls
auto.cnf  ib_buffer_pool  ibtmp1           performance_schema
db        ibdata1         mysql            sys
db1       ib_logfile0     mysql.sock       xtrabackup_binlog_pos_innodb
gamedb    ib_logfile1     mysql.sock.lock  xtrabackup_info
[root@host50 mysql]# mv  db1  db11
[root@host50 mysql]# ls
auto.cnf  ib_buffer_pool  ibtmp1           performance_schema
db        ibdata1         mysql            sys
db11      ib_logfile0     mysql.sock       xtrabackup_binlog_pos_innodb
gamedb    ib_logfile1     mysql.sock.lock  xtrabackup_info

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| db                 |
| db11               |
| gamedb             |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
7 rows in set (0.01 sec)

###################################################################

--修改数据库表名：
 alter table v1 rename v2;              //把v1表改为v2,内容不变

mysql> select  *  from  STUDENT;
+-----+--------+------+---------------------+-------+
| SNO | SNAME  | SSEX | SBIRTHDAY           | CLASS |
+-----+--------+------+---------------------+-------+
| 108 | 曾华   | 男   | 1977-09-01 00:00:00 | 95033 |
| 105 | 匡明   | 男   | 1975-10-02 00:00:00 | 95031 |
| 107 | 王丽   | 女   | 1976-01-23 00:00:00 | 95033 |
| 101 | 李军   | 男   | 1976-02-20 00:00:00 | 95033 |
| 109 | 王芳   | 女   | 1975-02-10 00:00:00 | 95031 |
| 103 | 陆君   | 男   | 1974-06-03 00:00:00 | 95031 |
+-----+--------+------+---------------------+-------+
6 rows in set (0.00 sec)

--mysql> ALTER table STUDENT rename student;
Query OK, 0 rows affected (0.05 sec)

mysql> show tables;
+---------------+
| Tables_in_db1 |
+---------------+
| student       |
+---------------+
1 row in set (0.00 sec)

--修改字段名：

alter table v1 change age xx char(11);  //把v1表中age字段改为xx字段
+---------+---------------------------+------+-----+---------+-------+
| Field   | Type                      | Null | Key | Default | Extra |
+---------+---------------------------+------+-----+---------+-------+
| stu_num | char(9)                   | YES  |     | NULL    |       |
| name    | varchar(15)               | YES  |     | NULL    |       |
| class   | char(7)                   | YES  |     | NULL    |       |
| likes   | set('eat','sleep','game') | YES  |     | NULL    |       |
| xx      | char(11)                  | YES  |     | NULL    |       |
+---------+---------------------------+------+-----+---------+-------+

--修改字段类型:
alter table v1 modify name varchar(15);//修改v1表中name字段类型为varchar(15)
+---------+---------------------------+------+-----+---------+-------+
| Field   | Type                      | Null | Key | Default | Extra |
+---------+---------------------------+------+-----+---------+-------+
| stu_num | char(9)                   | YES  |     | NULL    |       |
| name    | varchar(15)               | YES  |     | NULL    |       |
| class   | char(7)                   | YES  |     | NULL    |       |
| age     | tinyint(2)                | YES  |     | NULL    |       |
| likes   | set('eat','sleep','game') | YES  |     | NULL    |       |
+---------+---------------------------+------+-----+---------+-------+

alter table v1 modify age int(2) not null default 18;
--修改字段类型时,若新的类型与字段已经存储的数据冲突,不允许修改,不修改的部分要原样抄下来,否则就是还原
+---------+---------------------------+------+-----+---------+-------+
| Field   | Type                      | Null | Key | Default | Extra |
+---------+---------------------------+------+-----+---------+-------+
| stu_num | char(9)                   | YES  |     | NULL    |       |
| name    | varchar(15)               | YES  |     | NULL    |       |
| class   | char(7)                   | YES  |     | NULL    |       |
| age     | int(2)                    | NO   |     | 18      |       |
| likes   | set('eat','sleep','game') | YES  |     | NULL    |       |
+---------+---------------------------+------+-----+---------+-------+

--修改字段位置:
alter table v1 modify age int(2) not null default 18 after likes;
                                       //把age字段移到likes之后,其他不变
+---------+---------------------------+------+-----+---------+-------+
| Field   | Type                      | Null | Key | Default | Extra |
+---------+---------------------------+------+-----+---------+-------+
| stu_num | char(9)                   | YES  |     | NULL    |       |
| name    | varchar(15)               | YES  |     | NULL    |       |
| class   | char(7)                   | YES  |     | NULL    |       |
| likes   | set('eat','sleep','game') | YES  |     | NULL    |       |
| age     | int(2)                    | NO   |     | 18      |       |
+---------+---------------------------+------+-----+---------+-------+

--修改表中已存在的记录：

mysql> select  * from  student;
+-----+--------+------+---------------------+-------+
| SNO | SNAME  | SSEX | SBIRTHDAY           | ons   |
+-----+--------+------+---------------------+-------+
| 108 | 曾华   | 男   | 1977-09-01 00:00:00 | 95033 |
| 105 | 匡明   | 男   | 1975-10-02 00:00:00 | 95031 |
| 107 | 王丽   | 女   | 1976-01-23 00:00:00 | 95033 |
| 101 | 李军   | 男   | 1976-02-20 00:00:00 | 95033 |
| 109 | 王芳   | 女   | 1975-02-10 00:00:00 | 95031 |
| 103 | 陆君   | 男   | 1974-06-03 00:00:00 | 95031 |
+-----+--------+------+---------------------+-------+
6 rows in set (0.00 sec)

mysql> update  student set SNAME='增肥' where SNO=108;
Query OK, 1 row affected (0.03 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select  * from  student;
+-----+--------+------+---------------------+-------+
| SNO | SNAME  | SSEX | SBIRTHDAY           | ons   |
+-----+--------+------+---------------------+-------+
| 108 | 增肥   | 男   | 1977-09-01 00:00:00 | 95033 |
| 105 | 匡明   | 男   | 1975-10-02 00:00:00 | 95031 |
| 107 | 王丽   | 女   | 1976-01-23 00:00:00 | 95033 |
| 101 | 李军   | 男   | 1976-02-20 00:00:00 | 95033 |
| 109 | 王芳   | 女   | 1975-02-10 00:00:00 | 95031 |
| 103 | 陆君   | 男   | 1974-06-03 00:00:00 | 95031 |
+-----+--------+------+---------------------+-------+
6 rows in set (0.00 sec)

###################################################################

2018年 07月 18日 星期三 09:16:58 CST

--innobackupex增量备份

第一次备份 所有数据
]#innobackupex   --user root  --password  123456  /fullbak  --no-timestamp 

完全备份后插入数据

insert into  gamedb.a  values(56565),(23);

insert  into  gamedb.b  values(1213),(655621);



对数据增量备份：
]# innobackupex  --user root --password 123456 --incremental  /new1dir  --incremental-basedir=/fullbak  --no-timestamp 

增量备份后想表中存储新数据
insert  into  gamedb.a  values(982238),(56640);
insert  into  gamedb.b  values(828982238),(520000);

对数据增量备份：
]# innobackupex  --user root --password 123456 --incremental  /new2dir  --incremental-basedir=/new1dir  --no-timestamp 



vim  /root/allbak.sh
#!/bin/bash

day=`date +%F`
innobackupex  --user root --password 123456 --incremental  /fullbak_{day} --no-timestamp
:x


vim /root/newallbak.sh
#!/bin/bash
jt=`date +%d`
zt=`expr  $jt - 1`
m=`date +%m`
innobackupex  --user root --password 123456 --incremental  /new${m}_${jt}dir  --incremental-basedir=/new${m}_${zt}dir  --no-timestamp
:x
 
chmod +x /root/allbak.sh
chmod +x /root/newallbak.sh
crontab -e 
00 23  * *  1          /root/allbak.sh
00 23  * *  2-7        /root/newallbak.sh

--innobackupex 增量恢复

准备恢复数据

]#innobackupex  --user root --password 123456 --apply-log  --redo-only  /fullbak

]#innobackupex  --user root --password 123456 --apply-log  --redo-only  /fullbak  --incremental-dir=/new1dir

]#innobackupex  --user root --password 123456 --apply-log  --redo-only  /fullbak  --incremental-dir=/new2dir

]#rm -rf  /new1dir/     

]#rm -rf  /new1dir/     


sysytemctl  stop mysqld
rm -rf  /var/lib/mysql/ *


把备份目录下的数据拷贝到数据库目录并修改所有者和组为mysql
]#innobackupex  --user root --password 123456 --copy-back  /fullbak
]#chown  -R  mysql:mysql  /var/lib/mysql


启动数据库服务
]#systemctl  restart mysqld	


恢复数据后插入数据后继续增量备份

mysql>insert  into  a  values(555555555),(22222222),(1111111111);
mysql> insert  into  a  values(57985),(254489872),(11566111);

]#innobackupex  --user root --password  123456  --incremental /dir1  --incremental-basedir=/fullbak  --no-timestamp 

#################################################################################


多表查询
复制表:备份表   快速建表

备份表:
create table xxx select * from yyy;
create table user select * from usertab;
                           //以usertab的结构和数据建一张表user
+---------+---------------------+------+-----+---------+-------+
| Field   | Type                | Null | Key | Default | Extra |
+---------+---------------------+------+-----+---------+-------+
| id      | int(3)              | NO   |     | NULL    |       |
| name    | char(150)           | YES  |     | NULL    |       |
| age     | tinyint(2) unsigned | YES  |     | 18      |       |
| passwd  | char(10)            | YES  |     | NULL    |       |
| uid     | int(8)              | YES  |     | NULL    |       |
| gid     | int(8)              | YES  |     | NULL    |       |
| homedir | char(150)           | YES  |     | NULL    |       |
| shell   | char(150)           | YES  |     | NULL    |       |
+---------+---------------------+------+-----+---------+-------+
                                     //user内容和usertab一模一样

create table user1 select name,uid,shell from user order by uid limit 5;
                                 //查找user表中name,uid,shell的信息,
                                     按照uid的值从小到大排列显示前5行,
                                        最后用此查询结果创建一张user1表
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| NULL   | NULL | NULL          |
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
+--------+------+---------------+

快速建表:
create table user2 select * from user where name="1";
                               //以一个没结果的查询来复制表即为快速建表
                               //user表中没有name为1的行
+---------+---------------------+------+-----+---------+-------+
| Field   | Type                | Null | Key | Default | Extra |
+---------+---------------------+------+-----+---------+-------+
| id      | int(3)              | NO   |     | NULL    |       |
| name    | char(150)           | YES  |     | NULL    |       |
| age     | tinyint(2) unsigned | YES  |     | 18      |       |
| passwd  | char(10)            | YES  |     | NULL    |       |
| uid     | int(8)              | YES  |     | NULL    |       |
| gid     | int(8)              | YES  |     | NULL    |       |
| homedir | char(150)           | YES  |     | NULL    |       |
| shell   | char(150)           | YES  |     | NULL    |       |
+---------+---------------------+------+-----+---------+-------+

多表查询:
select 字段名列表 from 表名列表 where 条件;

create table v1 select name,uid,gid,shell from 晨练.user limit 3;
                 //用晨练库里user表中name,uid,gid,shell行的前三个值创建新表v1
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
+--------+------+---------------+

create table v2 select name,passwd,gid,homedir from 晨练.user limit 5;
              //用晨练库里user表中的name,passwd,gid,homedir行的前5个值创建新表v2
+--------+--------+------+----------------+
| name   | passwd | gid  | homedir        |
+--------+--------+------+----------------+
| root   | x      |    0 | /root          |
| bin    | x      |    1 | /bin           |
| daemon | x      |    2 | /sbin          |
| adm    | x      |    4 | /var/adm       |
| lp     | x      |    7 | /var/spool/lpd |
+--------+--------+------+----------------+

笛卡尔集
select * from v1,v2;                    //结果为笛卡尔集,共有15行
+--------+------+---------------+--------+--------+------+----------------+
| name   | uid  | shell         | name   | passwd | gid  | homedir        |
+--------+------+---------------+--------+--------+------+----------------+
| root   |    0 | /sbin/nologin | root   | x      |    0 | /root          |
| bin    |    1 | /sbin/nologin | root   | x      |    0 | /root          |
| daemon |    2 | /sbin/nologin | root   | x      |    0 | /root          |
| root   |    0 | /sbin/nolo
多表查询
复制表:备份表   快速建表

备份表:
create table xxx select * from yyy;
create table user select * from usertab;
                           //以usertab的结构和数据建一张表user
+---------+---------------------+------+-----+---------+-------+
| Field   | Type                | Null | Key | Default | Extra |
+---------+---------------------+------+-----+---------+-------+
| id      | int(3)              | NO   |     | NULL    |       |
| name    | char(150)           | YES  |     | NULL    |       |
| age     | tinyint(2) unsigned | YES  |     | 18      |       |
| passwd  | char(10)            | YES  |     | NULL    |       |
| uid     | int(8)              | YES  |     | NULL    |       |
| gid     | int(8)              | YES  |     | NULL    |       |
| homedir | char(150)           | YES  |     | NULL    |       |
| shell   | char(150)           | YES  |     | NULL    |       |
+---------+---------------------+------+-----+---------+-------+
                                     //user内容和usertab一模一样

create table user1 select name,uid,shell from user order by uid limit 5;
                                 //查找user表中name,uid,shell的信息,
                                     按照uid的值从小到大排列显示前5行,
                                        最后用此查询结果创建一张user1表
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| NULL   | NULL | NULL          |
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
+--------+------+---------------+

快速建表:
create table user2 select * from user where name="1";
                               //以一个没结果的查询来复制表即为快速建表
                               //user表中没有name为1的行
+---------+---------------------+------+-----+---------+-------+
| Field   | Type                | Null | Key | Default | Extra |
+---------+---------------------+------+-----+---------+-------+
| id      | int(3)              | NO   |     | NULL    |       |
| name    | char(150)           | YES  |     | NULL    |       |
| age     | tinyint(2) unsigned | YES  |     | 18      |       |
| passwd  | char(10)            | YES  |     | NULL    |       |
| uid     | int(8)              | YES  |     | NULL    |       |
| gid     | int(8)              | YES  |     | NULL    |       |
| homedir | char(150)           | YES  |     | NULL    |       |
| shell   | char(150)           | YES  |     | NULL    |       |
+---------+---------------------+------+-----+---------+-------+

多表查询:
select 字段名列表 from 表名列表 where 条件;

create table v1 select name,uid,gid,shell from 晨练.user limit 3;
                 //用晨练库里user表中name,uid,gid,shell行的前三个值创建新表v1
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
+--------+------+---------------+

create table v2 select name,passwd,gid,homedir from 晨练.user limit 5;
              //用晨练库里user表中的name,passwd,gid,homedir行的前5个值创建新表v2
+--------+--------+------+----------------+
| name   | passwd | gid  | homedir        |
+--------+--------+------+----------------+
| root   | x      |    0 | /root          |
| bin    | x      |    1 | /bin           |
| daemon | x      |    2 | /sbin          |
| adm    | x      |    4 | /var/adm       |
| lp     | x      |    7 | /var/spool/lpd |
+--------+--------+------+----------------+

笛卡尔集
select * from v1,v2;                    //结果为笛卡尔集,共有15行
+--------+------+---------------+--------+--------+------+----------------+
| name   | uid  | shell         | name   | passwd | gid  | homedir        |
+--------+------+---------------+--------+--------+------+----------------+
| root   |    0 | /sbin/nologin | root   | x      |    0 | /root          |
| bin    |    1 | /sbin/nologin | root   | x      |    0 | /root          |
| daemon |    2 | /sbin/nologin | root   | x      |    0 | /root          |
| root   |    0 | /sbin/nologin | bin    | x      |    1 | /bin           |
| bin    |    1 | /sbin/nologin | bin    | x      |    1 | /bin           |
| daemon |    2 | /sbin/nologin | bin    | x      |    1 | /bin           |
| root   |    0 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| bin    |    1 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| daemon |    2 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| root   |    0 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| bin    |    1 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| daemon |    2 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| root   |    0 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
| bin    |    1 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
| daemon |    2 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
+--------+------+---------------+--------+--------+------+----------------+
         
select v1.*,v2.passwd,v2.gid,v2.homedir from v1,v2;
+--------+------+---------------+--------+------+----------------+
| name   | uid  | shell         | passwd | gid  | homedir        |
+--------+------+---------------+--------+------+----------------+
| root   |    0 | /sbin/nologin | x      |    0 | /root          |
| bin    |    1 | /sbin/nologin | x      |    0 | /root          |
| daemon |    2 | /sbin/nologin | x      |    0 | /root          |
| root   |    0 | /sbin/nologin | x      |    1 | /bin           |
| bin    |    1 | /sbin/nologin | x      |    1 | /bin           |
| daemon |    2 | /sbin/nologin | x      |    1 | /bin           |
| root   |    0 | /sbin/nologin | x      |    2 | /sbin          |
| bin    |    1 | /sbin/nologin | x      |    2 | /sbin          |
| daemon |    2 | /sbin/nologin | x      |    2 | /sbin          |
| root   |    0 | /sbin/nologin | x      |    4 | /var/adm       |
| bin    |    1 | /sbin/nologin | x      |    4 | /var/adm       |
| daemon |    2 | /sbin/nologin | x      |    4 | /var/adm       |
| root   |    0 | /sbin/nologin | x      |    7 | /var/spool/lpd |
| bin    |    1 | /sbin/nologin | x      |    7 | /var/spool/lpd |
| daemon |    2 | /sbin/nologin | x      |    7 | /var/spool/lpd |
+--------+------+---------------+--------+------+----------------+
         //v1表中的每一列都和v2表中的每一列匹配并显示一次,所以v2表每一列都会显示3次

select v1.*,v2.passwd,v2.gid,v2.homedir from v1,v2 where v1.name=v2.name;
+--------+------+---------------+--------+------+---------+
| name   | uid  | shell         | passwd | gid  | homedir |
+--------+------+---------------+--------+------+---------+
| root   |    0 | /sbin/nologin | x      |    0 | /root   |
| bin    |    1 | /sbin/nologin | x      |    1 | /bin    |
| daemon |    2 | /sbin/nologin | x      |    2 | /sbin   |
+--------+------+---------------+--------+------+---------+

select v1.*,v2.name,v2.passwd,v2.gid,v2.homedir 
from v1,v2 where v1.name=v2.name;
+--------+------+---------------+--------+--------+------+---------+
| name   | uid  | shell         | name   | passwd | gid  | homedir |
+--------+------+---------------+--------+--------+------+---------+
| root   |    0 | /sbin/nologin | root   | x      |    0 | /root   |
| bin    |    1 | /sbin/nologin | bin    | x      |    1 | /bin    |
| daemon |    2 | /sbin/nologin | daemon | x      |    2 | /sbin   |
+--------+------+---------------+--------+--------+------+---------+
                                //只显示v1,v2表中name字段相同的行的数据

嵌套查询:
select 字段名列表 from 表名 where 条件(select 字段名列表 from 表名 where 条件);
                                //把括号内的查询结果作为括号外查询条件
select name,uid from 晨练.user where uid>(select avg(uid) from 晨练.user);
                               //查询晨练库user表中uid大于uid平均值的值
+-----------+-------+
| name      | uid   |
+-----------+-------+
| nfsnobody | 65535 |
+-----------+-------+

select name from 晨练.user where name in (select name from db4.v1);
                                 //查看晨练库user表与db4库v1表中同时存在的用户
+--------+
| name   |
+--------+
| root   |
| bin    |
| daemon |
+--------+

链接查询:
create table v3 select name,uid,shell from 晨练.user limit 5;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin |
+--------+------+---------------+

create table v4 select name,uid,shell from 晨练.user limit 7;
+----------+------+----------------+
| name     | uid  | shell          |
+----------+------+----------------+
| root     |    0 | /sbin/nologin  |
| bin      |    1 | /sbin/nologin  |
| daemon   |    2 | /sbin/nologin  |
| adm      |    3 | /sbin/nologin  |
| lp       |    4 | /sbin/nologin  |
| sync     |    5 | /sbin/nologin  |
| shutdown |    6 | /sbin/shutdown |
+----------+------+----------------+

左链接:以左边的表为主显示查询结果 left join
select 字段名列表 from 表名1 left jion 表名2 on 条件;
select * from v3 left join v4 on v3.uid=v4.uid;
                        //以v3表为主显示v3表中uid与v4表中uid相等的行的所有值
+--------+------+---------------+--------+------+---------------+
| name   | uid  | shell         | name   | uid  | shell         |
+--------+------+---------------+--------+------+---------------+
| root   |    0 | /sbin/nologin | root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin | bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin | daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin | adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin | lp     |    4 | /sbin/nologin |
+--------+------+---------------+--------+------+---------------+

右链接:以右边的表为主显示查询结果 right join
select 字段名列表 from 表名1 right jion 表名2 on 条件;
select * from v3 right join v4 on v3.uid=v4.uid;
                        //以v4表为主显示v3表中uid与v4表中uid相等的行的所有值
+--------+------+---------------+----------+------+----------------+
| name   | uid  | shell         | name     | uid  | shell          |
+--------+------+---------------+----------+------+----------------+
| root   |    0 | /sbin/nologin | root     |    0 | /sbin/nologin  |
| bin    |    1 | /sbin/nologin | bin      |    1 | /sbin/nologin  |
| daemon |    2 | /sbin/nologin | daemon   |    2 | /sbin/nologin  |
| adm    |    3 | /sbin/nologin | adm      |    3 | /sbin/nologin  |
| lp     |    4 | /sbin/nologin | lp       |    4 | /sbin/nologin  |
多表查询
复制表:备份表   快速建表

备份表:
create table xxx select * from yyy;
create table user select * from usertab;
                           //以usertab的结构和数据建一张表user
+---------+---------------------+------+-----+---------+-------+
| Field   | Type                | Null | Key | Default | Extra |
+---------+---------------------+------+-----+---------+-------+
| id      | int(3)              | NO   |     | NULL    |       |
| name    | char(150)           | YES  |     | NULL    |       |
| age     | tinyint(2) unsigned | YES  |     | 18      |       |
| passwd  | char(10)            | YES  |     | NULL    |       |
| uid     | int(8)              | YES  |     | NULL    |       |
| gid     | int(8)              | YES  |     | NULL    |       |
| homedir | char(150)           | YES  |     | NULL    |       |
| shell   | char(150)           | YES  |     | NULL    |       |
+---------+---------------------+------+-----+---------+-------+
                                     //user内容和usertab一模一样

create table user1 select name,uid,shell from user order by uid limit 5;
                                 //查找user表中name,uid,shell的信息,
                                     按照uid的值从小到大排列显示前5行,
                                        最后用此查询结果创建一张user1表
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| NULL   | NULL | NULL          |
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
+--------+------+---------------+

快速建表:
create table user2 select * from user where name="1";
                               //以一个没结果的查询来复制表即为快速建表
                               //user表中没有name为1的行
+---------+---------------------+------+-----+---------+-------+
| Field   | Type                | Null | Key | Default | Extra |
+---------+---------------------+------+-----+---------+-------+
| id      | int(3)              | NO   |     | NULL    |       |
| name    | char(150)           | YES  |     | NULL    |       |
| age     | tinyint(2) unsigned | YES  |     | 18      |       |
| passwd  | char(10)            | YES  |     | NULL    |       |
| uid     | int(8)              | YES  |     | NULL    |       |
| gid     | int(8)              | YES  |     | NULL    |       |
| homedir | char(150)           | YES  |     | NULL    |       |
| shell   | char(150)           | YES  |     | NULL    |       |
+---------+---------------------+------+-----+---------+-------+

多表查询:
select 字段名列表 from 表名列表 where 条件;

create table v1 select name,uid,gid,shell from 晨练.user limit 3;
                 //用晨练库里user表中name,uid,gid,shell行的前三个值创建新表v1
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
+--------+------+---------------+

create table v2 select name,passwd,gid,homedir from 晨练.user limit 5;
              //用晨练库里user表中的name,passwd,gid,homedir行的前5个值创建新表v2
+--------+--------+------+----------------+
| name   | passwd | gid  | homedir        |
+--------+--------+------+----------------+
| root   | x      |    0 | /root          |
| bin    | x      |    1 | /bin           |
| daemon | x      |    2 | /sbin          |
| adm    | x      |    4 | /var/adm       |
| lp     | x      |    7 | /var/spool/lpd |
+--------+--------+------+----------------+

笛卡尔集
select * from v1,v2;                    //结果为笛卡尔集,共有15行
+--------+------+---------------+--------+--------+------+----------------+
| name   | uid  | shell         | name   | passwd | gid  | homedir        |
+--------+------+---------------+--------+--------+------+----------------+
| root   |    0 | /sbin/nologin | root   | x      |    0 | /root          |
| bin    |    1 | /sbin/nologin | root   | x      |    0 | /root          |
| daemon |    2 | /sbin/nologin | root   | x      |    0 | /root          |
| root   |    0 | /sbin/nologin | bin    | x      |    1 | /bin           |
| bin    |    1 | /sbin/nologin | bin    | x      |    1 | /bin           |
| daemon |    2 | /sbin/nologin | bin    | x      |    1 | /bin           |
| root   |    0 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| bin    |    1 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| daemon |    2 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| root   |    0 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| bin    |    1 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| daemon |    2 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| root   |    0 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
| bin    |    1 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
| daemon |    2 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
+--------+------+---------------+--------+--------+------+----------------+
         
select v1.*,v2.passwd,v2.gid,v2.homedir from v1,v2;
+--------+------+---------------+--------+------+----------------+
| name   | uid  | shell         | passwd | gid  | homedir        |
+--------+------+---------------+--------+------+----------------+
| root   |    0 | /sbin/nologin | x      |    0 | /root          |
| bin    |    1 | /sbin/nologin | x      |    0 | /root          |
| daemon |    2 | /sbin/nologin | x      |    0 | /root          |
| root   |    0 | /sbin/nologin | x      |    1 | /bin           |
| bin    |    1 | /sbin/nologin | x      |    1 | /bin           |
| daemon |    2 | /sbin/nologin | x      |    1 | /bin           |
| root   |    0 | /sbin/nologin | x      |    2 | /sbin          |
| bin    |    1 | /sbin/nologin | x      |    2 | /sbin          |
| daemon |    2 | /sbin/nologin | x      |    2 | /sbin          |
| root   |    0 | /sbin/nologin | x      |    4 | /var/adm       |
| bin    |    1 | /sbin/nologin | x      |    4 | /var/adm       |
| daemon |    2 | /sbin/nologin | x      |    4 | /var/adm       |
| root   |    0 | /sbin/nologin | x      |    7 | /var/spool/lpd |
| bin    |    1 | /sbin/nologin | x      |    7 | /var/spool/lpd |
| daemon |    2 | /sbin/nologin | x      |    7 | /var/spool/lpd |
+--------+------+---------------+--------+------+----------------+
         //v1表中的每一列都和v2表中的每一列匹配并显示一次,所以v2表每一列都会显示3次

select v1.*,v2.passwd,v2.gid,v2.homedir from v1,v2 where v1.name=v2.name;
+--------+------+---------------+--------+------+---------+
| name   | uid  | shell         | passwd | gid  | homedir |
+--------+------+---------------+--------+------+---------+
| root   |    0 | /sbin/nologin | x      |    0 | /root   |
| bin    |    1 | /sbin/nologin | x      |    1 | /bin    |
| daemon |    2 | /sbin/nologin | x      |    2 | /sbin   |
+--------+------+---------------+--------+------+---------+

select v1.*,v2.name,v2.passwd,v2.gid,v2.homedir 
from v1,v2 where v1.name=v2.name;
+--------+------+---------------+--------+--------+------+---------+
| name   | uid  | shell         | name   | passwd | gid  | homedir |
+--------+------+---------------+--------+--------+------+---------+
| root   |    0 | /sbin/nologin | root   | x      |    0 | /root   |
| bin    |    1 | /sbin/nologin | bin    | x      |    1 | /bin    |
| daemon |    2 | /sbin/nologin | daemon | x      |    2 | /sbin   |
+--------+------+---------------+--------+--------+------+---------+
                                //只显示v1,v2表中name字段相同的行的数据

嵌套查询:
select 字段名列表 from 表名 where 条件(select 字段名列表 from 表名 where 条件);
                                //把括号内的查询结果作为括号外查询条件
select name,uid from 晨练.user where uid>(select avg(uid) from 晨练.user);
                               //查询晨练库user表中uid大于uid平均值的值
+-----------+-------+
| name      | uid   |
+-----------+-------+
| nfsnobody | 65535 |
+-----------+-------+

select name from 晨练.user where name in (select name from db4.v1);
                                 //查看晨练库user表与db4库v1表中同时存在的用户
+--------+
| name   |
+--------+
| root   |
| bin    |
| daemon |
+--------+

链接查询:
create table v3 select name,uid,shell from 晨练.user limit 5;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin |
+--------+------+---------------+

create table v4 select name,uid,shell from 晨练.user limit 7;
+----------+------+----------------+
| name     | uid  | shell          |
+----------+------+----------------+
| root     |    0 | /sbin/nologin  |
| bin      |    1 | /sbin/nologin  |
| daemon   |    2 | /sbin/nologin  |
| adm      |    3 | /sbin/nologin  |
| lp       |    4 | /sbin/nologin  |
| sync     |    5 | /sbin/nologin  |
| shutdown |    6 | /sbin/shutdown |
+----------+------+----------------+

左链接:以左边的表为主显示查询结果 left join
select 字段名列表 from 表名1 left jion 表名2 on 条件;
select * from v3 left join v4 on v3.uid=v4.uid;
                        //以v3表为主显示v3表中uid与v4表中uid相等的行的所有值
+--------+------+---------------+--------+------+---------------+
| name   | uid  | shell         | name   | uid  | shell         |
+--------+------+---------------+--------+------+---------------+
| root   |    0 | /sbin/nologin | root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin | bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin | daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin | adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin | lp     |    4 | /sbin/nologin |
+--------+------+---------------+--------+------+---------------+

右链接:以右边的表为主显示查询结果 right join
select 字段名列表 from 表名1 right jion 表名2 on 条件;
select * from v3 right join v4 on v3.uid=v4.uid;
                        //以v4表为主显示v3表中uid与v4表中uid相等的行的所有值
+--------+------+---------------+----------+------+----------------+
| name   | uid  | shell         | name     | uid  | shell          |
+--------+------+---------------+----------+------+----------------+
| root   |    0 | /sbin/nologin | root     |    0 | /sbin/nologin  |
| bin    |    1 | /sbin/nologin | bin      |    1 | /sbin/nologin  |
| daemon |    2 | /sbin/nologin | daemon   |    2 | /sbin/nologin  |
| adm    |    3 | /sbin/nologin | adm      |    3 | /sbin/nologin  |
| lp     |    4 | /sbin/nologin | lp       |    4 | /sbin/nologin  |
| NULL   | NULL | NULL          | sync     |    5 | /sbin/nologin  |
| NULL   | NULL | NULL          | shutdown |    6 | /sbin/shutdown |
+--------+------+---------------+----------+------+----------------+

安装phpMyAdmin:
部署环境LAMP或者LNMP
yum -y install httpd php php-mysql 
systemctl restart httpd

tar -xf phpMyAdmin-2.11.11-all-languages.tar.gz 
                                  //解包
cd phpMyAdmin-2.11.11-all-languages/
                                  //进目录
mv phpMyAdmin-2.11.11-all-languages /var/www/html/phpadmin
                                  //移动到网页目录下并改名

创建配置文件,指定管理数据库的服务器
cd /var/www/html/phpadmin
                                  //进入目录
cp config.sample.inc.php config.inc.php
                                  //拷贝模板文件创建配置文件
vim config.inc.php
                                  //修改配置文件
firefox http://192.168.4.50/phpadmin     
                                  //链接网页版数据库

创建授权:
grant 权限列表 on 库名.表名
grant all on *.* to ljw@'192.168.4.%' identified by "123456";
                   //192.168.4.0网段可以用ljw,密码123456来登录mysql

grant all on *.* to ljw@'%' identified by "123456";
                   //所有主机都可以用ljw,密码123456来登录mysql

grant select,insert on 晨练.user to ljw@'192.168.4.254' identified by "123456";
                  //192.168.4.254主机可以用ljw,密码123456来登录mysql,
                     对晨练库的user表有查询和插入权限

Query OK, 0 rows affected, 1 warning (0.00 sec)
                                      //命令执行成功的提示
| NULL   | NULL | NULL          | sync     |    5 | /sbin/nologin  |
| NULL   | NULL | NULL          | shutdown |    6 | /sbin/shutdown |
+--------+------+---------------+----------+------+----------------+

安装phpMyAdmin:
部署环境LAMP或者LNMP
yum -y install httpd php php-mysql 
systemctl restart httpd

tar -xf phpMyAdmin-2.11.11-all-languages.tar.gz 
                                  //解包
cd phpMyAdmin-2.11.11-all-languages/
                                  //进目录
mv phpMyAdmin-2.11.11-all-languages /var/www/html/phpadmin
                                  //移动到网页目录下并改名

创建配置文件,指定管理数据库的服务器
cd /var/www/html/phpadmin
                                  //进入目录
cp config.sample.inc.php config.inc.php
                                  //拷贝模板文件创建配置文件
vim config.inc.php
                                  //修改配置文件
firefox http://192.168.4.50/phpadmin     
                                  //链接网页版数据库

创建授权:
grant 权限列表 on 库名.表名
grant all on *.* to ljw@'192.168.4.%' identified by "123456";
                   //192.168.4.0网段可以用ljw,密码123456来登录mysql

grant all on *.* to ljw@'%' identified by "123456";
                   //所有主机都可以用ljw,密码123456来登录mysql

grant select,insert on 晨练.user to ljw@'192.168.4.254' identified by "123456";
                  //192.168.4.254主机可以用ljw,密码123456来登录mysql,
                     对晨练库的user表有查询和插入权限

Query OK, 0 rows affected, 1 warning (0.00 sec)
                                      //命令执行成功的提示gin | bin    | x      |    1 | /bin           |
| bin    |    1 | /sbin/nologin | bin    | x      |    1 | /bin           |
| daemon |    2 | /sbin/nologin | bin    | x      |    1 | /bin           |
| root   |    0 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| bin    |    1 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| daemon |    2 | /sbin/nologin | daemon | x      |    2 | /sbin          |
| root   |    0 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| bin    |    1 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| daemon |    2 | /sbin/nologin | adm    | x      |    4 | /var/adm       |
| root   |    0 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
| bin    |    1 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
| daemon |    2 | /sbin/nologin | lp     | x      |    7 | /var/spool/lpd |
+--------+------+---------------+--------+--------+------+----------------+
         
select v1.*,v2.passwd,v2.gid,v2.homedir from v1,v2;
+--------+------+---------------+--------+------+----------------+
| name   | uid  | shell         | passwd | gid  | homedir        |
+--------+------+---------------+--------+------+----------------+
| root   |    0 | /sbin/nologin | x      |    0 | /root          |
| bin    |    1 | /sbin/nologin | x      |    0 | /root          |
| daemon |    2 | /sbin/nologin | x      |    0 | /root          |
| root   |    0 | /sbin/nologin | x      |    1 | /bin           |
| bin    |    1 | /sbin/nologin | x      |    1 | /bin           |
| daemon |    2 | /sbin/nologin | x      |    1 | /bin           |
| root   |    0 | /sbin/nologin | x      |    2 | /sbin          |
| bin    |    1 | /sbin/nologin | x      |    2 | /sbin          |
| daemon |    2 | /sbin/nologin | x      |    2 | /sbin          |
| root   |    0 | /sbin/nologin | x      |    4 | /var/adm       |
| bin    |    1 | /sbin/nologin | x      |    4 | /var/adm       |
| daemon |    2 | /sbin/nologin | x      |    4 | /var/adm       |
| root   |    0 | /sbin/nologin | x      |    7 | /var/spool/lpd |
| bin    |    1 | /sbin/nologin | x      |    7 | /var/spool/lpd |
| daemon |    2 | /sbin/nologin | x      |    7 | /var/spool/lpd |
+--------+------+---------------+--------+------+----------------+
         //v1表中的每一列都和v2表中的每一列匹配并显示一次,所以v2表每一列都会显示3次

select v1.*,v2.passwd,v2.gid,v2.homedir from v1,v2 where v1.name=v2.name;
+--------+------+---------------+--------+------+---------+
| name   | uid  | shell         | passwd | gid  | homedir |
+--------+------+---------------+--------+------+---------+
| root   |    0 | /sbin/nologin | x      |    0 | /root   |
| bin    |    1 | /sbin/nologin | x      |    1 | /bin    |
| daemon |    2 | /sbin/nologin | x      |    2 | /sbin   |
+--------+------+---------------+--------+------+---------+

select v1.*,v2.name,v2.passwd,v2.gid,v2.homedir 
from v1,v2 where v1.name=v2.name;
+--------+------+---------------+--------+--------+------+---------+
| name   | uid  | shell         | name   | passwd | gid  | homedir |
+--------+------+---------------+--------+--------+------+---------+
| root   |    0 | /sbin/nologin | root   | x      |    0 | /root   |
| bin    |    1 | /sbin/nologin | bin    | x      |    1 | /bin    |
| daemon |    2 | /sbin/nologin | daemon | x      |    2 | /sbin   |
+--------+------+---------------+--------+--------+------+---------+
                                //只显示v1,v2表中name字段相同的行的数据

嵌套查询:
select 字段名列表 from 表名 where 条件(select 字段名列表 from 表名 where 条件);
                                //把括号内的查询结果作为括号外查询条件
select name,uid from 晨练.user where uid>(select avg(uid) from 晨练.user);
                               //查询晨练库user表中uid大于uid平均值的值
+-----------+-------+
| name      | uid   |
+-----------+-------+
| nfsnobody | 65535 |
+-----------+-------+

select name from 晨练.user where name in (select name from db4.v1);
                                 //查看晨练库user表与db4库v1表中同时存在的用户
+--------+
| name   |
+--------+
| root   |
| bin    |
| daemon |
+--------+

链接查询:
create table v3 select name,uid,shell from 晨练.user limit 5;
+--------+------+---------------+
| name   | uid  | shell         |
+--------+------+---------------+
| root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin |
+--------+------+---------------+

create table v4 select name,uid,shell from 晨练.user limit 7;
+----------+------+----------------+
| name     | uid  | shell          |
+----------+------+----------------+
| root     |    0 | /sbin/nologin  |
| bin      |    1 | /sbin/nologin  |
| daemon   |    2 | /sbin/nologin  |
| adm      |    3 | /sbin/nologin  |
| lp       |    4 | /sbin/nologin  |
| sync     |    5 | /sbin/nologin  |
| shutdown |    6 | /sbin/shutdown |
+----------+------+----------------+

左链接:以左边的表为主显示查询结果 left join
select 字段名列表 from 表名1 left jion 表名2 on 条件;
select * from v3 left join v4 on v3.uid=v4.uid;
                        //以v3表为主显示v3表中uid与v4表中uid相等的行的所有值
+--------+------+---------------+--------+------+---------------+
| name   | uid  | shell         | name   | uid  | shell         |
+--------+------+---------------+--------+------+---------------+
| root   |    0 | /sbin/nologin | root   |    0 | /sbin/nologin |
| bin    |    1 | /sbin/nologin | bin    |    1 | /sbin/nologin |
| daemon |    2 | /sbin/nologin | daemon |    2 | /sbin/nologin |
| adm    |    3 | /sbin/nologin | adm    |    3 | /sbin/nologin |
| lp     |    4 | /sbin/nologin | lp     |    4 | /sbin/nologin |
+--------+------+---------------+--------+------+---------------+

右链接:以右边的表为主显示查询结果 right join
select 字段名列表 from 表名1 right jion 表名2 on 条件;
select * from v3 right join v4 on v3.uid=v4.uid;
                        //以v4表为主显示v3表中uid与v4表中uid相等的行的所有值
+--------+------+---------------+----------+------+----------------+
| name   | uid  | shell         | name     | uid  | shell          |
+--------+------+---------------+----------+------+----------------+
| root   |    0 | /sbin/nologin | root     |    0 | /sbin/nologin  |
| bin    |    1 | /sbin/nologin | bin      |    1 | /sbin/nologin  |
| daemon |    2 | /sbin/nologin | daemon   |    2 | /sbin/nologin  |
| adm    |    3 | /sbin/nologin | adm      |    3 | /sbin/nologin  |
| lp     |    4 | /sbin/nologin | lp       |    4 | /sbin/nologin  |
| NULL   | NULL | NULL          | sync     |    5 | /sbin/nologin  |
| NULL   | NULL | NULL          | shutdown |    6 | /sbin/shutdown |
+--------+------+---------------+----------+------+----------------+

安装phpMyAdmin:
部署环境LAMP或者LNMP
yum -y install httpd php php-mysql 
systemctl restart httpd

tar -xf phpMyAdmin-2.11.11-all-languages.tar.gz 
                                  //解包
cd phpMyAdmin-2.11.11-all-languages/
                                  //进目录
mv phpMyAdmin-2.11.11-all-languages /var/www/html/phpadmin
                                  //移动到网页目录下并改名

创建配置文件,指定管理数据库的服务器
cd /var/www/html/phpadmin
                                  //进入目录
cp config.sample.inc.php config.inc.php
                                  //拷贝模板文件创建配置文件
vim config.inc.php
                                  //修改配置文件
firefox http://192.168.4.50/phpadmin     
                                  //链接网页版数据库

创建授权:
grant 权限列表 on 库名.表名
grant all on *.* to ljw@'192.168.4.%' identified by "123456";
                   //192.168.4.0网段可以用ljw,密码123456来登录mysql

grant all on *.* to ljw@'%' identified by "123456";
                   //所有主机都可以用ljw,密码123456来登录mysql

grant select,insert on 晨练.user to ljw@'192.168.4.254' identified by "123456";
                  //192.168.4.254主机可以用ljw,密码123456来登录mysql,
                     对晨练库的user表有查询和插入权限

Query OK, 0 rows affected, 1 warning (0.00 sec)
                                      //命令执行成功的提示
####################################################################################################################


innobackupex   --user  root   --password  123456  --databases="gamedb"  /gamedb  --no-timestamp
 
mysql> drop table a;

恢复单个表
create table gamedb.a(id int);
select *  from gamedb.a;

alter  table gamedb.a discard tablespace;


























